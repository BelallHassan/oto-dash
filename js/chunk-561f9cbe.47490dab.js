(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-561f9cbe"],{"305d":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ViewTransactionPopup"),n("refund-popup",{on:{refunded:function(t){return e.handleRefunding("succeeded")},failed:function(t){return e.handleRefunding("failed")}}}),n("content-section",{attrs:{spacing:!1}},[n("div",{staticClass:"content-spacing"},[n("div",{staticClass:"grid grid-cols-1 mb-10 md:grid-cols-2"},[n("div",{},[n("title-plus",{attrs:{title:"Transaction Management","hide-plus":!0}})],1),n("div",{staticClass:"flex md:justify-end"},[n("date-range-picker",{on:{"apply-date":function(t){return e.handleApplyDate(t)},"cancel-date":function(t){return e.handleCancelDate(t)}}})],1)]),n("div",{staticClass:"flex flex-col mt-4 mb-10 md:items-center md:flex-row"},[n("card-tax-stat",{directives:[{name:"show",rawName:"v-show",value:"credit"===e.currentTab,expression:"currentTab === 'credit'"}],staticClass:"mr-3",attrs:{title:"Total Credit",value:e.symbol+" "+e.indexMetaData.summary.total_credit,variant:"purple"}}),n("card-tax-stat",{directives:[{name:"show",rawName:"v-show",value:"credit"===e.currentTab,expression:"currentTab === 'credit'"}],staticClass:"mr-3",attrs:{title:"AVG Credit/Day",value:e.symbol+" "+e.indexMetaData.summary.avg_credit_per_day,variant:"orange"}}),n("card-tax-stat",{directives:[{name:"show",rawName:"v-show",value:"debit"===e.currentTab,expression:"currentTab === 'debit'"}],staticClass:"mr-3",attrs:{title:"Total Debit",value:e.symbol+" "+e.indexMetaData.summary.total_debit,variant:"green"}}),n("card-tax-stat",{directives:[{name:"show",rawName:"v-show",value:"debit"===e.currentTab,expression:"currentTab === 'debit'"}],staticClass:"mr-3",attrs:{title:"AVG Debit/Day",value:e.symbol+" "+e.indexMetaData.summary.avg_debit_per_day,variant:"blue"}})],1),n("div",{staticClass:"grid grid-cols-1 md:grid-cols-2"},[n("div",[n("oto-search",{model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("div",{staticClass:"flex md:justify-end "},[n("transaction-tabs",{staticClass:"mr-2",on:{debit:function(t){return e.handleTabs(t)},credit:function(t){return e.handleTabs(t)}}}),n("export-as-dropdown")],1)])]),n("fsTableContainer",{staticClass:"vld-parent"},[n("loading",{attrs:{active:e.isLoading,"is-full-page":!1},on:{"update:active":function(t){e.isLoading=t}}}),n("fsTable",[n("fsTableHead",e._l(e.currentTableHeaders,(function(t,a){return n("fsTableHeadItem",{key:"fs-table-header-"+a,attrs:{item:t},on:{"apply-sorting":function(t){return e.handleSorting(t)}}})})),1),e._l(e.indexData,(function(t,a){return n("fsTableRow",{key:"fs-table-row-"+a},[n("fsTableRowItem",["debit"===e.currentTab?[n("router-link",{staticClass:"font-bold text-blue-600 capitalize",attrs:{to:{name:"ViewTrip",params:{id:t.trip}}}},[e._v(" #"+e._s(e._f("onlyLastFive")(t.id))+" ")])]:e._e(),"credit"===e.currentTab?[n("div",{staticClass:"font-bold text-blue-600 capitalize cursor-pointer",on:{click:function(n){return e.popup(t)}}},[e._v(" #"+e._s(e._f("onlyLastFive")(t.id))+" ")]),n("router-view")]:e._e()],2),n("fsTableRowItem",[t.tax_plan?[e._v(" "+e._s(e._f("onlyLastFive")(t.tax_plan))+" ")]:[e._v(" -- ")]],2),n("fsTableRowItem",[t.user?[n("router-link",{staticClass:"font-bold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:t.user.id}}}},[e._v(" "+e._s(t.user.full_name)+" ")])]:[e._v(" -- ")]],2),"credit"===e.currentTab?n("fsTableRowItem",[t.user?[e._v(" "+e._s(t.user.role_name)+" ")]:[e._v(" -- ")]],2):e._e(),n("fsTableRowItem",[e._v(" "+e._s(e.$localTime(t.date))+" ")]),n("fsTableRowItem",[e._v(" "+e._s(t.payment_method)+" ")]),n("fsTableRowItem",[e._v(" "+e._s(t.payment_for)+" ")]),n("fsTableRowItem",[n("span",{domProps:{innerHTML:e._s(e.printAmount(t.payment_method,t.amount))}})]),n("fsTableRowItem",[n("div",{staticClass:"flex items-center"},["debit"===e.currentTab?[n("oto-eye-icon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(n){return e.onInvoiceModalReq(t.trip,!1)}}})]:[n("oto-eye-icon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(n){return e.popup(t)}}})]],2)]),"debit"===e.currentTab?[n("fsTableRowItem",[n("div",{staticClass:"refund-action",class:t.is_refunded?"refunded":"refund",on:{click:function(n){return e.showRefundPopup(t)}}},[e._v(" "+e._s(t.is_refunded?"Refunded":"Refund")+" ")])])]:e._e()],2)}))],2),n("fs-table-foot",{attrs:{"total-items":e.indexMetaData.count.total,"pagination-summary":e.paginationSummary}})],1)],1),n("InvoiceModal",{attrs:{trip:e.invoiceModalDetails,symbol:e.symbol}})],1)},r=[],i=n("1da1"),o=n("5530"),s=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("99af"),n("b680"),n("a434"),n("2f62")),d=n("47d7"),c=n("4a9d"),u=n("d71a"),l=n.n(u),f=n("885d"),p=n("8349"),m=n.n(p),b=n("458d"),h=n.n(b),v=n("ce4a"),g=n.n(v),w=n("d4da"),y=n("ed08"),_={name:"ViewOrganizationUserPayments",mixins:[l.a,f["a"],m.a,h.a,g.a,w["a"]],components:{ContentSection:function(){return n.e("chunk-2d22cfc9").then(n.bind(null,"f625"))},TitlePlus:function(){return n.e("chunk-4d9af094").then(n.bind(null,"bcf7"))},OtoEyeIcon:function(){return n.e("chunk-2d2105ec").then(n.bind(null,"b833"))},DateRangePicker:function(){return Promise.all([n.e("chunk-93f91af4"),n.e("chunk-86a01c7a")]).then(n.bind(null,"d519"))},OtoSearch:function(){return n.e("chunk-6db62d91").then(n.bind(null,"d792"))},ExportAsDropdown:function(){return n.e("chunk-56afd618").then(n.bind(null,"63fb"))},CardTaxStat:function(){return n.e("chunk-4a3dd2eb").then(n.bind(null,"ab00"))},TransactionTabs:function(){return n.e("chunk-0ee73265").then(n.bind(null,"0c38"))},ViewTransactionPopup:function(){return n.e("chunk-26430e5a").then(n.bind(null,"1495"))},RefundPopup:function(){return n.e("chunk-092d4b04").then(n.bind(null,"6cbf"))},InvoiceModal:function(){return Promise.all([n.e("chunk-5bc08480"),n.e("chunk-23f5cf5f"),n.e("chunk-976b0870"),n.e("chunk-23565cf8"),n.e("chunk-4ceea968")]).then(n.bind(null,"7b26"))}},data:function(){return{symbol:"$",indexMetaData:{summary:{total_credit:"0.00",avg_credit_per_day:"0.00",total_debit:"0.00",avg_debit_per_day:"0.00"},count:{total:0}},indexDataEndpoint:d["a"].api.index,currentTab:"debit",currentTableHeaders:[{name:"Invoice ID",width:"10%",field:"id",sort:!1,order:""},{name:"Tax ID",width:"10%",field:"tax",sort:null,order:""},{name:"Rider",width:"10%",field:"user",sort:null,order:""},{name:"Payer Role",width:"10%",field:"user",sort:!1,order:""},{name:"Transaction Time",width:"15%",field:"date",sort:!0,order:""},{name:"Payment Method",width:"15%",field:"payment",sort:!0,order:""},{name:"Payment for",width:"10%",field:"payment_for",sort:!0,order:""},{name:"Amount",width:"10%",field:"amount",sort:!0,order:""},{name:"Invoice",width:"10%",field:null,sort:null,order:""}],invoiceModalState:!1,invoiceModalDetails:{}}},created:function(){this.handleTabs("debit")},computed:Object(o["a"])(Object(o["a"])({},Object(s["b"])("auth",["organizationInfo"])),{},{id:function(){return this.$route.params.id}}),mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.symbol=e.organizationInfo.default_currency?e.organizationInfo.default_currency.symbol:"$",window.addEventListener(d["a"].events.refresh,(function(){e.getIndexData(e.getQueryString)}));case 2:case"end":return t.stop()}}),t)})))()},methods:{getTransactionStatus:function(e){var t={P:"Paid",U:"Unpaid"};return e in t?t[e]:"-"},getTransactionStatusBadge:function(e){var t={P:"green",U:"red"};return e in t?t[e]:"red"},edit:function(e){console.log(e)},popup:function(e){c["a"].$emit(d["a"].events.viewingData,e),this.$modal.show(d["a"].events.viewingData)},showRefundPopup:function(e){e.is_refunded||(c["a"].$emit(d["a"].events.refundPopup,e),this.$modal.show(d["a"].events.refundPopup))},handleRefunding:function(){var e=arguments,t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:"failed","succeeded"!==a){n.next=6;break}return n.next=4,t.getIndexData(t.getQueryString);case 4:return t.$notify({group:"generic",type:"success",title:"Refunded",text:"Successfully refunded to the rider."},3e3),n.abrupt("return");case 6:case"end":return n.stop()}}),n)})))()},getActionsEndpoint:function(e){return d["a"].api.update(e)},printAmount:function(e,t){var n="Card"===e?"text-oGreen":"";return'<span class="'.concat(n,'">').concat(this.symbol," ").concat(t?parseFloat(t).toFixed(2):"0.00","</span>")},handleTabs:function(e){"credit"===e&&(this.currentTableHeaders.splice(2,1,{name:"Payer Name",width:"10%",field:"user",sort:!1,order:""},{name:"Payer Role",width:"10%",field:"user",sort:!1,order:""}),this.currentTableHeaders.pop(),this.queryString.transaction_type="CREDIT",this.queryStringOptions.append="&_far="+Math.random().toFixed(2)+"&franchise_user="+this.$route.params.id),"debit"===e&&(this.currentTableHeaders.splice(2,2,{name:"Rider",width:"10%",field:"user",sort:!1,order:""}),this.currentTableHeaders.push({name:"Actions",width:"10%",field:null,sort:null,order:""}),this.queryString.transaction_type="DEBIT",this.queryStringOptions.append="&_han="+Math.random().toFixed(2)+"&franchise_user="+this.$route.params.id),this.currentTab=e,console.log(this.queryString),this.getIndexData(this.getQueryString)},onInvoiceModalReq:function(e){var t=arguments,n=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.length>1&&void 0!==t[1]&&t[1],n.$notify({group:"generic",type:"default",title:"Processing",text:"The action is being executed..."},600),a.next=4,n.$http.get(n.$config.trip.api.single(e),{params:{preferred_currency:Object(y["u"])("fsTable.organizationCurrency.selected",n.$store.state)}}).then((function(e){n.invoiceModalDetails=e.data,!0===r?n.$refs.invoiceModal&&n.$refs.invoiceModal.exportToPDF():n.$modal.show("invoiceModal")})).catch((function(e){n.$notify({group:"generic",type:"error",title:"Server Error [".concat(e.response.status,"]"),text:"Unable to process the request!"},5e3)}));case 4:case"end":return a.stop()}}),a)})))()}}},T=_,x=(n("bea8"),n("2877")),R=Object(x["a"])(T,a,r,!1,null,"3d88148e",null);t["default"]=R.exports},"47d7":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={api:{index:"/dashboard/invoices/",single:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uuid";return"/dashboard/invoices/?trip=".concat(e)},create:"/dashboard/invoices/",update:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uuid";return"/dashboard/invoices/".concat(e,"/")},refund:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"invoice-uuid";return"/dashboard/invoices/".concat(e,"/refund/")}},events:{name:"invoices",refresh:"rid-trip",sorId:"trip",sorOpen:"sor-open-trip",sorClose:"sor-close-trip",sorToggle:"sor-toggle-trip",editingData:"edit-trip-data",viewingData:"view-transaction-data",refundPopup:"refund-popup",policyPenaltyPopup:"policy-penalty-popup"}}},bea8:function(e,t,n){"use strict";n("e1cb")},d71a:function(e,t){var n={data:function(){return{isLoading:!1}}};e.exports=n},e1cb:function(e,t,n){}}]);
//# sourceMappingURL=chunk-561f9cbe.47490dab.js.map