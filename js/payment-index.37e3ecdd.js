(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["payment-index"],{"084b":function(t,e,n){"use strict";n("43a6")},"086e":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var a={api:{},events:{refundRequestPopup:"RefundRequestPopup"}}},"2d8f":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("base-layout",[n("content-section",{attrs:{spacing:!1}},[n("div",{staticClass:"content-spacing"},[n("div",{staticClass:"grid grid-cols-1 mb-10 md:grid-cols-2"},[n("div",[n("title-plus",{attrs:{title:"Refund Request","hide-plus":!0}})],1),n("div",{staticClass:"flex md:justify-end"},[n("date-range-picker",{on:{"apply-date":t.onApplyFilterDateRange,"cancel-date":t.onApplyFilterDateRange}})],1)])]),t.$acl.canView("transaction")?[n("FSTable",{attrs:{"fst-id":"refundRequest",endpoint:t.getEndpoint,headers:t.getTableHeaders,exportFor:"refundRequest"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return[t._l(a,(function(e,a){return["full"===t.getTableMode?[n("FSTableRow",{key:a,attrs:{"text-fallback-always":""},on:{meta:function(e){return t.indexMetaData=e}}},[n("FSTableRowItem",{attrs:{text:e.id,truncate:-5}}),n("FSTableRowItem",[e.rider?n("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:e.rider.id}},target:"_blank"}},[t._v(" "+t._s(e.rider.full_name)+" ")]):n("span",[t._v(" -- ")])],1),n("FSTableRowItem",{attrs:{text:""+e.currency.symbol+e.requested_amount}}),n("FSTableRowItem",{attrs:{text:e.refunded_amount?""+e.currency.symbol+e.refunded_amount:"--"}}),n("FSTableRowItem",{attrs:{text:e.refundable_amount?""+e.currency.symbol+e.refundable_amount:"--"}}),n("FSTableRowItem",[e.reference_ids?t._l(e.reference_ids,(function(e,a){return n("span",{key:a,staticClass:"text-blue-500 px-1"},[n("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+e}},[t._v(t._s(t.truncate(e,-5,"")))]),n("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(n){return t.copyTextToClipboard("https://dashboard.stripe.com/payments/"+e)}}},[n("i",{staticClass:"ml-2 far fa-copy"})])])})):n("span",[t._v("--")])],2),n("FSTableRowItem",{attrs:{text:e.created_at,date:""}}),n("FSTableRowItem",[n("XStatus",{attrs:{text:e.status_display_text,variant:t.getVariant(e.status)}})],1),n("FSTableRowItem",[0===e.status?n("div",{staticClass:"flex items-center "},[[n("t-dropdown",{attrs:{variant:"smActions"},scopedSlots:t._u([{key:"trigger",fn:function(t){var e=t.mousedownHandler,a=t.focusHandler,s=t.blurHandler,r=t.keydownHandler;return[n("button",{staticClass:"focus:outline-none",attrs:{"aria-label":"More Actions","aria-haspopup":"true"},on:{mousedown:e,focus:a,blur:s,keydown:r}},[n("svg",{staticClass:"w-6 h-5 mt-1 text-oGray hover:text-oDark",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"}})])])]}},{key:"default",fn:function(a){var s=a.hide;return[n("div",{staticClass:"py-1 mt-px bg-white rounded-md shadow-md cursor-pointer",on:{click:function(t){return s()}}},[n("t-dropdown-item",{on:{click:function(n){return t.onRefundReq(e)}}},[t._v(" Refund ")])],1)]}}],null,!0)})]],2):n("div",[t._v("--")])])],1)]:t._e(),"responsive"===t.getTableMode?[n("FSTableRow",{key:"fs-table-row-"+a,attrs:{textFallbackAlways:""}},[n("FSTableRowItem",[n("div",{staticClass:"col-span-1 focus:text-gray-400",on:{click:function(e){return t.toggle(a)}}},[t.opened.includes(a)?n("i",{staticClass:"fas fa-minus-circle",staticStyle:{color:"#d90a20"}}):n("i",{staticClass:"fas fa-plus-circle"})])]),n("FSTableRowItem",[e.rider?n("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:e.rider.id}},target:"_blank"}},[t._v(" "+t._s(e.rider.full_name)+" ")]):n("span",[t._v(" -- ")])],1),n("FSTableRowItem",{attrs:{text:""+e.currency.symbol+e.requested_amount}}),n("FSTableRowItem",[n("XStatus",{attrs:{text:e.status_display_text,variant:t.getVariant(e.status)}})],1)],1),t.opened.includes(a)?n("FSTableRow",{key:a},[n("td",{attrs:{colspan:"10"}},[n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("ID"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(t._f("onlyLastFive")(e.id))+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("Refunded Amount"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" $"+t._s(t.$t(e.refunded_amount))+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("Refundable Amount"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(e.refundable_amount?"$"+t.$t(e.refundable_amount):"--")+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("Payment Ref"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[e.reference_ids?t._l(e.reference_ids,(function(e,a){return n("span",{key:a,staticClass:"text-blue-500 px-1"},[n("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+e}},[t._v(t._s(t.truncate(e,-5,"")))]),n("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(n){return t.copyTextToClipboard("https://dashboard.stripe.com/payments/"+e)}}},[n("i",{staticClass:"ml-2 far fa-copy"})])])})):n("span",[t._v("--")])],2)]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("Request at"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(t._f("friendlyDateTime")(e.created_at))+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("Action"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[0===e.status?n("div",{staticClass:"flex items-center "},[[n("t-dropdown",{attrs:{variant:"smActions"},scopedSlots:t._u([{key:"trigger",fn:function(t){var e=t.mousedownHandler,a=t.focusHandler,s=t.blurHandler,r=t.keydownHandler;return[n("button",{staticClass:"focus:outline-none",attrs:{"aria-label":"More Actions","aria-haspopup":"true"},on:{mousedown:e,focus:a,blur:s,keydown:r}},[n("svg",{staticClass:"w-6 h-5 mt-1 text-oGray hover:text-oDark",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"}})])])]}},{key:"default",fn:function(a){var s=a.hide;return[n("div",{staticClass:"py-1 mt-px bg-white rounded-md shadow-md cursor-pointer",on:{click:function(t){return s()}}},[n("t-dropdown-item",{on:{click:function(n){return t.onRefundReq(e)}}},[t._v(" Refund ")])],1)]}}],null,!0)})]],2):n("div",[t._v("--")])])])])]):t._e()]:t._e()]}))]}}],null,!1,1890420458)})]:n("div",{staticClass:"py-5 font-bold text-center text-gray-600"},[t._v(" "+t._s(t.$t("components.acl.doNotHavePermission"))+" ")])],2),n("RefundRequestPopup",{on:{refresh:function(e){return t.$store.dispatch("fsTable/fetchData")}}})],1)},s=[],r=(n("d3b7"),n("3ca3"),n("ddb0"),n("a434"),n("4138")),i=n("c820"),o=n("086e"),c=n("4a6d"),l=n("ed08"),u={name:"RefundRequestIndex",components:{BaseLayout:function(){return Promise.all([n.e("chunk-25be9760"),n.e("chunk-09bc5093"),n.e("chunk-875ae294"),n.e("chunk-5ee7a1fe")]).then(n.bind(null,"9bf1"))},ContentSection:function(){return n.e("chunk-2d22cfc9").then(n.bind(null,"f625"))},TitlePlus:function(){return n.e("chunk-4d9af094").then(n.bind(null,"bcf7"))},DateRangePicker:function(){return Promise.all([n.e("chunk-93f91af4"),n.e("chunk-86a01c7a")]).then(n.bind(null,"d519"))},XStatus:function(){return n.e("chunk-531bf962").then(n.bind(null,"229c"))},RefundRequestPopup:function(){return n.e("chunk-2d0b25b8").then(n.bind(null,"2488"))},TDropdownItem:function(){return Promise.resolve().then(n.bind(null,"92c2"))},FSTable:r["a"],FSTableRow:r["d"],FSTableRowItem:r["e"]},computed:{getTableHeaders:function(){return this.windowWidth<=930?this.resTableHeaders:this.tableHeaders},getTableMode:function(){return this.windowWidth<=930?"responsive":"full"},getEndpoint:function(){return i["c"].refundApplication.index()}},data:function(){return{symbol:"$",popupData:{},statusMap:{0:"Pending",1:"Processed",2:"Revoked",3:"Rejected"},windowWidth:window.innerWidth,opened:[],tableHeaders:[{text:"Id",width:"5%",sort:null},{text:"Rider Name",width:"10%",sort:null},{text:"Requested Amount",width:"10%",sort:null},{text:"Refunded Amount",width:"10%",sort:null},{text:"Refundable Amount",width:"10%",sort:null},{text:"Payment Ref",width:"10%",sort:null},{text:"Request at",width:"12%",sort:null},{text:"Status",width:"10%",sort:null},{text:"Action",width:"10%",sort:null}],resTableHeaders:[{text:"",width:"10%",sort:null},{text:"Rider Name",width:"40%",sort:null},{text:"Requested Amount",width:"30%",sort:null},{text:"Status",width:"10%",sort:null}]}},mounted:function(){var t=this;this.$nextTick((function(){window.addEventListener("resize",t.onResize)}))},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{onApplyFilterDateRange:r["g"],truncate:c["a"],onRefundReq:function(t){this.$modal.show("RefundRequestPopup"),l["a"].$emit(o["a"].events.refundRequestPopup,t)},getVariant:function(t){return 0===t?"orange":1===t?"green":"red"},copyTextToClipboard:function(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-99999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$notify({group:"generic",type:"success",title:"Payment Reference link Copied",text:"The Payment Reference link has been copied to your clipboard"},2e3)},onResize:function(){this.windowWidth=window.innerWidth},toggle:function(t){var e=this.opened.indexOf(t);e>-1?this.opened.splice(e,1):this.opened.push(t)}}},d=u,m=(n("084b"),n("2877")),p=Object(m["a"])(d,a,s,!1,null,"48564d32",null);e["default"]=p.exports},"43a6":function(t,e,n){},6093:function(t,e,n){"use strict";n("6973")},6973:function(t,e,n){},"870d":function(t,e,n){},"8eb78":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("base-layout",[n("InvoiceModal",{attrs:{trip:t.invoiceModalDetails,symbol:t.symbol}}),n("content-section",{attrs:{spacing:!1}},[n("div",{staticClass:"content-spacing"},[n("div",{staticClass:"grid grid-cols-1 mb-10 md:grid-cols-2"},[n("div",[n("title-plus",{attrs:{title:t.$t("components.triggerPaymentManagement.headline"),"hide-plus":!0}})],1),n("div",{staticClass:"flex md:justify-end"},[n("date-range-picker",{on:{"apply-date":t.onApplyFilterDateRange,"cancel-date":t.onApplyFilterDateRange}})],1)]),n("div",{staticClass:"flex flex-col gap-4 mt-4 mb-10 md:items-center md:flex-row"},[n("SummaryCard",{attrs:{title:t.$t("components.triggerPaymentManagement.summary.totalTriggerPayment"),value:t.indexMetaData.summary.currency.symbol+" "+t.indexMetaData.summary.total_debit,variant:"gray"}}),n("SummaryCard",{attrs:{title:t.$t("components.triggerPaymentManagement.summary.successfulPayment"),value:t.indexMetaData.summary.currency.symbol+" "+(t.indexMetaData.summary.trigger_succeeded||"0.00"),variant:"gray"}}),n("SummaryCard",{attrs:{title:t.$t("components.triggerPaymentManagement.summary.unsuccessfulPayment"),value:t.indexMetaData.summary.currency.symbol+" "+(t.indexMetaData.summary.trigger_failed||"0.00"),variant:"gray"}})],1)]),t.$acl.canView("transaction")?[n("FSTable",{attrs:{"fst-id":"triggerPayment",endpoint:t.getEndpoint,headers:t.getTableHeaders,qso:{prepend:"",append:""},"currency-enabled":!0,exportType:t.exportKey.TRIGGER_PAYMENT,exportFromURL:!0,"currency-attributes":t.getCurrencyAttributes},on:{meta:function(e){return t.indexMetaData=e}},scopedSlots:t._u([{key:"topLeft",fn:function(e){var a=e.slotWidth;return[n("keep-alive",[n("FSTableFilter",{attrs:{"fst-id":"triggerPayment","slot-width":a,options:t.filterOptions}})],1)]}},{key:"default",fn:function(e){var a=e.data;return[t._l(a,(function(e,a){return["full"===t.getTableMode?[n("FSTableRow",{key:a,on:{meta:function(e){return t.indexMetaData=e}}},[e.trip&&""!==e.trip?n("FSTableRowItem",{attrs:{text:e.id,truncate:-5,to:{name:"ViewTrip",params:{id:e.trip}}}}):t._e(),e.trip&&""!==e.trip?t._e():n("FSTableRowItem",{attrs:{text:e.id,truncate:-5,"truncate-prepend":"#"}}),n("FSTableRowItem",[e.user?n("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:e.user.id}},target:"_blank"}},[t._v(" "+t._s(e.user.full_name)+" ")]):n("span",[t._v(" -- ")])],1),n("FSTableRowItem",[e.payment_method&&"--"!==e.payment_method?n("i",{class:t.getPaymentCardIconClass(e.payment_method_details)}):t._e(),e.payment_method&&"--"!==e.payment_method?n("span",[t._v("  ")]):t._e(),t._v(" "+t._s(e.payment_method)+" ")]),n("FSTableRowItem",{attrs:{text:e,"as-currency":""}}),n("FSTableRowItem",{attrs:{text:e.checkout.updated_at,date:""}}),n("FSTableRowItem",{attrs:{text:e.checkout.checkout_status}}),n("FSTableRowItem",{attrs:{text:e.checkout.retry_count.toString()}}),n("FSTableRowItem",{attrs:{text:e.payment_reference_id,"text-fallback":"--"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.text;return[n("span","--"===a?[t._v("--")]:["Stripe"===t.paymentMethod?n("span",{staticClass:"text-blue-500"},[n("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+a}},[t._v(t._s(t.truncate(a,-5,"")))]),n("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(e){return t.copyTextToClipboard("https://dashboard.stripe.com/payments/"+a)}}},[n("i",{staticClass:"ml-2 far fa-copy"})])]):n("span",[t._v(t._s(t.truncate(a,-5,"")))])])]}}],null,!0)}),n("FSTableRowItem",[n("div",{staticClass:"flex gap-1"},["FINALIZE_SUCCESS"!==e.checkout.checkout_status?n("div",[e.checkout.result_description?n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:""+e.checkout.result_description,expression:"`${item.checkout.result_description}`",modifiers:{top:!0}}],staticClass:"refund-action refund",on:{click:function(n){return t.onTrigger({tripId:e.id})}}},[t._v(" Trigger ")]):n("div",{staticClass:"refund-action refund",on:{click:function(n){return t.onTrigger({tripId:e.id})}}},[t._v(" Trigger ")])]):t._e(),"FINALIZE_SUCCESS"===e.checkout.checkout_status?n("div",{staticClass:"refund-action refund disabled"},[t._v(" Trigger ")]):t._e(),n("MoreActionsDropdown",{key:"more-actions-"+a,attrs:{id:"more-actions-"+a,data:e},on:{delete:function(e){return t.$store.dispatch("fsTable/fetchData")}}})],1)])],1)]:t._e(),"responsive"===t.getTableMode?[n("FSTableRow",{key:"fs-table-row-"+a,attrs:{"text-fallback-always":""},on:{meta:function(e){return t.indexMetaData=e}}},[n("FSTableRowItem",[n("div",{staticClass:"col-span-1 focus:text-gray-400",on:{click:function(e){return t.toggle(a)}}},[t.opened.includes(a)?n("i",{staticClass:"fas fa-minus-circle",staticStyle:{color:"#d90a20"}}):n("i",{staticClass:"fas fa-plus-circle"})])]),e.trip&&""!==e.trip?n("FSTableRowItem",{attrs:{text:e.id,truncate:-5,"truncate-prepend":"#",to:{name:"ViewTrip",params:{id:e.trip}}}}):t._e(),e.trip&&""!==e.trip?t._e():n("FSTableRowItem",{attrs:{text:e.id,truncate:-5,"truncate-prepend":"#"}}),n("FSTableRowItem",{attrs:{text:e.checkout.checkout_status}}),n("FSTableRowItem",{attrs:{text:e,"as-currency":""}})],1),t.opened.includes(a)?n("FSTableRow",{key:a},[n("td",{attrs:{colspan:"10"}},[n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.table.columns.rider"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[e.user?n("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:e.user.id}},target:"_blank"}},[t._v(" "+t._s(e.user.full_name)+" ")]):n("span",[t._v(" -- ")])],1)]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.table.columns.creditCard"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[e.payment_method&&"--"!==e.payment_method?n("i",{class:t.getPaymentCardIconClass(e.payment_method_details)}):t._e(),e.payment_method&&"--"!==e.payment_method?n("span",[t._v("  ")]):t._e(),t._v(" "+t._s(e.payment_method)+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.table.columns.lastTriggeredAt"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(t.getFormattedDateTime(e.checkout.updated_at,"D MMM, YY hh:mm:ss a")||"--")+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.table.columns.retryCount"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(e.checkout.retry_count.toString()||"--")+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.table.columns.paymentRef"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[e.payment_reference_id?n("span",["Stripe"===t.paymentMethod?n("span",{staticClass:"text-blue-500"},[n("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+e.payment_reference_id}},[t._v(t._s(t.truncate(e.payment_reference_id,-5,"")))]),n("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(n){return t.copyTextToClipboard("https://dashboard.stripe.com/payments/"+e.payment_reference_id)}}},[n("i",{staticClass:"ml-2 far fa-copy"})])]):n("span",[t._v(t._s(t.truncate(e.payment_reference_id,-5,"")))])]):n("span",[t._v("--")])])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.table.columns.actions"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[n("div",{staticClass:"flex gap-1"},["FINALIZE_SUCCESS"!==e.checkout.checkout_status?n("div",[e.checkout.result_description?n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:""+e.checkout.result_description,expression:"\n                              `${item.checkout.result_description}`\n                            ",modifiers:{top:!0}}],staticClass:"refund-action refund",on:{click:function(n){return t.onTrigger({tripId:e.id})}}},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.actions.trigger"))+" ")]):n("div",{staticClass:"refund-action refund",on:{click:function(n){return t.onTrigger({tripId:e.id})}}},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.actions.trigger"))+" ")])]):t._e(),"FINALIZE_SUCCESS"===e.checkout.checkout_status?n("div",{staticClass:"refund-action refund disabled"},[t._v(" "+t._s(t.$t("components.triggerPaymentManagement.actions.trigger"))+" ")]):t._e(),n("MoreActionsDropdown",{key:"more-actions-"+a,attrs:{id:"more-actions-"+a,data:e},on:{delete:function(e){return t.$store.dispatch("fsTable/fetchData")}}})],1)])])])]):t._e()]:t._e()]}))]}}],null,!1,1593921990)})]:n("div",{staticClass:"py-5 font-bold text-center text-gray-600"},[t._v(" "+t._s(t.$t("components.acl.doNotHavePermission"))+" ")])],2)],1)},s=[],r=n("1da1"),i=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("7db0"),n("b0c0"),n("a434"),n("159b"),n("4138")),o=n("c820"),c=n("ed08"),l=n("ca65"),u=n("4a6d"),d=n("214d"),m=n("ea91"),p={name:"Transactions",components:{BaseLayout:function(){return Promise.all([n.e("chunk-25be9760"),n.e("chunk-09bc5093"),n.e("chunk-875ae294"),n.e("chunk-5ee7a1fe")]).then(n.bind(null,"9bf1"))},ContentSection:function(){return n.e("chunk-2d22cfc9").then(n.bind(null,"f625"))},TitlePlus:function(){return n.e("chunk-4d9af094").then(n.bind(null,"bcf7"))},DateRangePicker:function(){return Promise.all([n.e("chunk-93f91af4"),n.e("chunk-86a01c7a")]).then(n.bind(null,"d519"))},SummaryCard:function(){return n.e("chunk-560dab74").then(n.bind(null,"5ce4"))},InvoiceModal:function(){return Promise.all([n.e("chunk-976b0870"),n.e("chunk-23565cf8"),n.e("chunk-4ceea968")]).then(n.bind(null,"7b26"))},FSTable:i["a"],FSTableRow:i["d"],FSTableRowItem:i["e"],FSTableFilter:i["b"],MoreActionsDropdown:d["a"]},data:function(){return{exportKey:m["a"],windowWidth:window.innerWidth,symbol:"$",indexMetaData:{summary:{currency:{symbol:""},total_credit:"0.00",avg_credit_per_day:"0.00",total_debit:"0.00",avg_debit_per_day:"0.00"},count:{total:0}},tableHeaders:[{text:this.$t("components.triggerPaymentManagement.table.columns.invoiceID"),width:"9%",sort:"id"},{text:this.$t("components.triggerPaymentManagement.table.columns.rider"),width:"10%",sort:"user"},{text:this.$t("components.triggerPaymentManagement.table.columns.creditCard"),width:"10%",sort:"tax"},{text:this.$t("components.triggerPaymentManagement.table.columns.amount"),width:"5%",sort:"user"},{text:this.$t("components.triggerPaymentManagement.table.columns.lastTriggeredAt"),width:"13%",sort:"date"},{text:this.$t("components.triggerPaymentManagement.table.columns.lastTriggerStatus"),width:"12%",sort:"payment"},{text:this.$t("components.triggerPaymentManagement.table.columns.retryCount"),width:"10%",sort:"payment_for"},{text:this.$t("components.triggerPaymentManagement.table.columns.paymentRef"),width:"15%",sort:null},{text:this.$t("components.triggerPaymentManagement.table.columns.actions"),width:"10%",sort:null}],resTableHeaders:[{text:"",width:"10%",sort:null},{text:this.$t("components.triggerPaymentManagement.table.columns.invoiceID"),width:"25%",sort:"id"},{text:this.$t("components.triggerPaymentManagement.table.columns.lastTriggerStatus"),width:"35%",sort:"checkout_status"},{text:this.$t("components.triggerPaymentManagement.table.columns.amount"),width:"30%",sort:"amount"}],opened:[],invoiceModalState:!1,invoiceModalDetails:{},filterOptions:null}},computed:{getEndpoint:function(){return o["c"].invoice.indexOfTriggerPayment()},getTableHeaders:function(){return this.windowWidth<=930?this.resTableHeaders:this.tableHeaders},getTableMode:function(){return this.windowWidth<=930?"responsive":"full"},getCurrencyAttributes:function(){return Object(i["f"])({root:"",def:{amount:"amount",currencyName:"currency.name",currencySymbol:"currency.symbol"},actual:{amount:"amount",currencyName:"currency.name",currencySymbol:"currency.symbol"}})}},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.symbol=(null===(n=t.$org)||void 0===n||null===(a=n.default_currency)||void 0===a?void 0:a.symbol)||"$",e.next=3,t.generateFilterOptions();case 3:return e.next=5,t.$http.get(o["c"].dropdown.paymentGateways()).then((function(t){return t.data.data})).catch((function(t){return console.log("paymentGatewayErr",t)}));case 5:s=e.sent,r=s.find((function(t){return t.id===JSON.parse(localStorage.getItem("organization")).default_payment_gateway_config.payment_gateway})),t.paymentMethod=r.name;case 8:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;this.$nextTick((function(){window.addEventListener("resize",t.onResize)}))},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{onApplyFilterDateRange:i["g"],getFormattedDateTime:l["c"],truncate:u["a"],onResize:function(){this.windowWidth=window.innerWidth},copyTextToClipboard:function(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-99999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$notify({group:"generic",type:"success",title:"Payment Reference link Copied",text:"The Payment Reference link has been copied to your clipboard"},2e3)},toggle:function(t){var e=this.opened.indexOf(t);e>-1?this.opened.splice(e,1):this.opened.push(t)},onTrigger:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.tripId,!e.$acl.canNotUpdate("transaction")){n.next=4;break}return e.$notify(e.$acl.notAbleToToast({action:"update",permission:"transaction"})),n.abrupt("return");case 4:e.$notify({group:"generic",type:"Default",title:"Attempting trigger payment",text:"The action is being executed. You'll be notified shortly."},1500),e.$http.post(o["c"].invoice.triggerNegativeBalanceResolver(a)).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$notify({group:"generic",type:"success",title:"Trigger Payment",text:n.data.detail}),t.next=3,e.$store.dispatch("fsTable/fetchData");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$notify({group:"generic",type:"danger",title:"Failed to trigger payment",text:t.response.detail})}));case 6:case"end":return n.stop()}}),n)})))()},onInvoiceModalReq:function(t){var e=arguments,n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e.length>1&&void 0!==e[1]&&e[1],n.$notify({group:"generic",type:"default",title:"Processing",text:"The action is being executed..."},600),a.next=4,n.$http.get(n.$config.trip.api.single(t),{params:{preferred_currency:Object(c["u"])("fsTable.organizationCurrency.selected",n.$store.state)}}).then((function(t){n.invoiceModalDetails=t.data,!0===s?n.$refs.invoiceModal&&n.$refs.invoiceModal.exportToPDF():n.$modal.show("invoiceModal")})).catch((function(t){n.$notify({group:"generic",type:"error",title:"Server Error [".concat(t.response.status,"]"),text:"Unable to process the request!"},5e3)}));case 4:case"end":return a.stop()}}),a)})))()},generateFilterOptions:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[{text:"Success",value:"FINALIZE_SUCCESS"},{text:"Failed",value:"FAILED"}],a=[{key:"checkout_status",type:"checkbox",input:n,title:"Status"},{key:"amount_range",type:"range",input:{value:[0,0],unit:t.symbol,max:1e3,minQs:"min_amount",maxQs:"max_amount"},title:"Amount"},{key:"retry_range",type:"range",input:{value:[0,0],unit:"",max:9,minQs:"min_retry",maxQs:"max_retry"},title:"Retry"}],!t.$acl.canView("fleets")){e.next=10;break}return s=[],e.next=6,t.$http.get("/dashboard/fleets/").then((function(t){var e=t.data;e.data.length&&e.data.forEach((function(t){s.push({text:t.name,value:t.id})}))}));case 6:a.unshift({key:"fleet",type:"checkbox",input:s,title:"Fleet"}),t.filterOptions=a,e.next=11;break;case 10:t.filterOptions=a;case 11:case"end":return e.stop()}}),e)})))()},getPaymentCardIconClass:function(t){var e,n=(null===t||void 0===t||null===(e=t.brand)||void 0===e?void 0:e.toLowerCase())||"",a="fab ";switch(null===n||void 0===n?void 0:n.toLowerCase()){case"visa":a+="fa-cc-visa";break;case"mastercard":a+="fa-cc-mastercard";break;case"americanexpress":a+="fa-cc-amex";break;case"discover":a+="fa-cc-discover";break;case"jcb":a+="fa-cc-jcb";break;case"dinersclub":a+="fa-cc-diners-club";break;default:a="fas fa-wallet";break}return a}}},f=p,y=(n("cef9"),n("2877")),b=Object(y["a"])(f,a,s,!1,null,"4a226b36",null);e["default"]=b.exports},9134:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("BaseLayout",[n("PaymentIndex",{attrs:{pageTitle:t.$t("components.paymentManagement.headline")}})],1)},s=[],r=(n("d3b7"),n("3ca3"),n("ddb0"),n("9c62")),i={name:"PaymentIndexPage",components:{BaseLayout:function(){return Promise.all([n.e("chunk-25be9760"),n.e("chunk-09bc5093"),n.e("chunk-875ae294"),n.e("chunk-5ee7a1fe")]).then(n.bind(null,"9bf1"))},PaymentIndex:r["a"]}},o=i,c=n("2877"),l=Object(c["a"])(o,a,s,!1,null,null,null);e["default"]=l.exports},"9c62":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("PaymentDetailsModal"),n("content-section",{attrs:{spacing:!1}},[n("div",{staticClass:"content-spacing"},[n("div",{staticClass:"grid grid-cols-1 mb-10 md:grid-cols-2"},[n("div",{},[n("title-plus",{attrs:{title:t.pageTitle,"hide-plus":!0}})],1),n("div",{staticClass:"flex md:justify-end"},[n("date-range-picker",{on:{"apply-date":t.onApplyFilterDateRange,"cancel-date":t.onApplyFilterDateRange}})],1)]),n("div",{staticClass:"flex flex-col gap-4 mt-4 mb-10 md:items-center md:flex-row"},[n("SummaryCard",{attrs:{title:t.$t("components.paymentManagement.summary.totalPayment"),value:t.indexMetaData.summary.currency.symbol+" "+t.indexMetaData.summary.total_credit,variant:"gray"}}),n("SummaryCard",{attrs:{title:t.$t("components.paymentManagement.summary.avgPaymentPerDay"),value:t.indexMetaData.summary.currency.symbol+" "+t.indexMetaData.summary.avg_credit_per_day,variant:"gray"}})],1)]),t.$acl.canView("transaction")?[n("FSTable",{attrs:{qso:t.qso,"fst-id":t.fstId,headers:t.getTableHeaders,exportType:t.exportKey.PAYMENT,exportFromURL:!0,endpoint:t.endpoint,"currency-enabled":!0,"currency-attributes":t.getCurrencyAttributes},on:{meta:function(e){return t.indexMetaData=e}},scopedSlots:t._u([{key:"topLeft",fn:function(e){var a=e.slotWidth;return[n("keep-alive",[n("FSTableFilter",{attrs:{"fst-id":t.fstId,"slot-width":a,options:t.getFilteredItems}})],1)]}},{key:"default",fn:function(e){var a=e.data;return[t._l(a,(function(e,a){return["full"===t.getTableMode?[n("FSTableRow",{key:a},[n("FSTableRowItem",[n("div",{staticClass:"font-bold text-blue-600 cursor-pointer",on:{click:function(n){return t.popup(e)}}},[t._v(" "+t._s(t._f("onlyLastFive")(e.id))+" ")])]),n("FSTableRowItem",[e.user?n("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:e.user.id}},target:"_blank"}},[t._v(" "+t._s(e.user.full_name)+" ")]):n("span",[t._v(" -- ")])],1),n("FSTableRowItem",{attrs:{text:e.date,date:""}}),e.payment_method_details?t._e():n("FSTableRowItem",{attrs:{text:e.payment_method}}),e.payment_method_details?n("FSTableRowItem",[e.payment_method&&"--"!==e.payment_method?n("i",{class:t.getPaymentCardIconClass(e.payment_method_details)}):t._e(),e.payment_method&&"--"!==e.payment_method?n("span",[t._v("  ")]):t._e(),t._v(" "+t._s(e.payment_method)+" ")]):t._e(),n("FSTableRowItem",{attrs:{text:e.payment_reference_id,"text-fallback":"--"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.text;return[n("span","--"===a?[t._v("--")]:["Stripe"===t.paymentMethod?n("span",{staticClass:"text-blue-500"},[n("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+a}},[t._v(t._s(t.truncate(a,-5,"")))]),n("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(e){return t.copyTextToClipboard("https://dashboard.stripe.com/payments/"+a)}}},[n("i",{staticClass:"ml-2 far fa-copy"})])]):n("span",[t._v(t._s(t.truncate(a,-5,"")))])])]}}],null,!0)}),n("FSTableRowItem",{attrs:{text:t.getPaymentForText(e.payment_for)}}),n("FSTableRowItem",[n("p",[t._v(" "+t._s(e.currency.symbol)+t._s(e.amount)+" "),e.riding_time_balance?n("span",[t._v("("+t._s(t.convertSecondsToMinutesAndSeconds(e.riding_time_balance))+")")]):t._e()]),e.tax_amount?n("p",{staticClass:"text-xs"},[t._v(" ( VAT "+t._s(e.currency.symbol)+t._s(e.tax_amount)+") ")]):t._e()]),n("FSTableRowItem",{attrs:{text:e.finalized_refund_amount?e.currency.symbol+" "+e.finalized_refund_amount:"--"}}),n("FSTableRowItem",[n("OtoEyeIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(n){return t.popup(e)}}})],1),n("FSTableRowItem",{staticClass:"flex gap-1"},[n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.getRefundTooltip(e),expression:"getRefundTooltip(item)",modifiers:{bottom:!0}}],staticClass:"refund-action",class:e.is_refunded?"refunded":e.is_source_refundable?"refund":"disabled",on:{click:function(n){return t.showRefundPopup(e)}}},[t._v(" "+t._s(e.is_refunded?t.$t("components.paymentManagement.actions.refunded"):t.$t("components.paymentManagement.actions.refund"))+" ")]),n("MoreActionsDropdown",{key:"more-actions-"+a,attrs:{id:"more-actions-"+a,data:e},on:{delete:function(e){return t.$store.dispatch("fsTable/fetchData")}}})],1)],1)]:t._e(),"responsive"===t.getTableMode?[n("FSTableRow",{key:"fs-table-row-"+a,attrs:{"text-fallback-always":""},on:{meta:function(e){return t.indexMetaData=e}}},[n("FSTableRowItem",[n("div",{staticClass:"col-span-1 focus:text-gray-400",on:{click:function(e){return t.toggle(a)}}},[t.opened.includes(a)?n("i",{staticClass:"fas fa-minus-circle",staticStyle:{color:"#d90a20"}}):n("i",{staticClass:"fas fa-plus-circle"})])]),n("FSTableRowItem",[n("div",{staticClass:"font-bold text-blue-600 capitalize cursor-pointer",on:{click:function(n){return t.popup(e)}}},[t._v(" #"+t._s(t._f("onlyLastFive")(e.id))+" ")])]),e.payment_method_details?t._e():n("FSTableRowItem",{attrs:{text:e.payment_method}}),e.payment_method_details?n("FSTableRowItem",[e.payment_method&&"--"!==e.payment_method?n("i",{class:t.getPaymentCardIconClass(e.payment_method_details)}):t._e(),e.payment_method&&"--"!==e.payment_method?n("span",[t._v("  ")]):t._e(),t._v(" "+t._s(e.payment_method)+" ")]):t._e(),n("FSTableRowItem",{attrs:{text:e,"as-currency":""}})],1),t.opened.includes(a)?n("FSTableRow",{key:a},[n("td",{attrs:{colspan:"10"}},[n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.paymentManagement.table.columns.payerName"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[e.user?n("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:e.user.id}},target:"_blank"}},[t._v(" "+t._s(e.user.full_name)+" ")]):n("span",[t._v(" -- ")])],1)]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.paymentManagement.table.columns.transactionTime"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(t.getFormattedDateTime(e.date,"D MMM, YY hh:mm:ss a")||"--")+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.paymentManagement.table.columns.paymentRef"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[e.payment_reference_id?n("span",["Stripe"===t.paymentMethod?n("span",{staticClass:"text-blue-500"},[n("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+e.payment_reference_id}},[t._v(t._s(t.truncate(e.payment_reference_id,-5,"")))]),n("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(n){return t.copyTextToClipboard("https://dashboard.stripe.com/payments/"+e.payment_reference_id)}}},[n("i",{staticClass:"ml-2 far fa-copy"})])]):n("span",[t._v(t._s(t.truncate(e.payment_reference_id,-5,"")))])]):n("span",[t._v("--")])])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.paymentManagement.table.columns.paymentFor"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[t._v(" "+t._s(t.getPaymentForText(e.payment_for)||"--")+" ")])]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.paymentManagement.table.columns.invoice"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[n("OtoEyeIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(n){return t.popup(e)}}})],1)]),n("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[n("div",{staticClass:"col-span-5 left-text"},[t._v(" "+t._s(t.$t("components.paymentManagement.table.columns.actions"))+" ")]),n("div",{staticClass:"col-span-5 right-text"},[n("div",{staticClass:"flex gap-1"},[n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.getRefundTooltip(e),expression:"getRefundTooltip(item)",modifiers:{bottom:!0}}],staticClass:"refund-action",class:e.is_refunded?"refunded":e.is_source_refundable?"refund":"disabled",on:{click:function(n){return t.showRefundPopup(e)}}},[t._v(" "+t._s(e.is_refunded?t.$t("components.paymentManagement.actions.refunded"):t.$t("components.paymentManagement.actions.refund"))+" ")]),n("MoreActionsDropdown",{key:"more-actions-"+a,attrs:{id:"more-actions-"+a,data:e},on:{delete:function(e){return t.$store.dispatch("fsTable/fetchData")}}})],1)])])])]):t._e()]:t._e()]}))]}}],null,!1,3825670073)})]:n("div",{staticClass:"py-5 font-bold text-center text-gray-600"},[t._v(" "+t._s(t.$t("components.acl.doNotHavePermission"))+" ")])],2),n("RefundModal",{on:{refunded:t.onRefunded}})],1)},s=[],r=n("1da1"),i=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("7db0"),n("b0c0"),n("a434"),n("99af"),n("b680"),n("159b"),n("4de4"),n("4a9d")),o=n("47d7"),c=n("ca65"),l=n("4138"),u=n("c820"),d=n("6930"),m=n("4a6d"),p=n("214d"),f=n("ea91"),y={name:"PaymentIndex",props:{pageTitle:{type:String,default:"Payment"},fstId:{type:String,default:"payments"},endpoint:{type:String,default:u["c"].invoice.indexOfPayment()},qso:{type:Object,default:function(){return{append:"",prepend:""}}},filterItems:{type:Array,default:function(){return[]}}},components:{ContentSection:function(){return n.e("chunk-2d22cfc9").then(n.bind(null,"f625"))},TitlePlus:function(){return n.e("chunk-4d9af094").then(n.bind(null,"bcf7"))},OtoEyeIcon:function(){return n.e("chunk-2d2105ec").then(n.bind(null,"b833"))},DateRangePicker:function(){return Promise.all([n.e("chunk-93f91af4"),n.e("chunk-86a01c7a")]).then(n.bind(null,"d519"))},SummaryCard:function(){return n.e("chunk-560dab74").then(n.bind(null,"5ce4"))},PaymentDetailsModal:function(){return n.e("chunk-26430e5a").then(n.bind(null,"1495"))},MoreActionsDropdown:p["a"],FSTable:l["a"],FSTableRow:l["d"],FSTableRowItem:l["e"],FSTableFilter:l["b"],RefundModal:function(){return n.e("chunk-092d4b04").then(n.bind(null,"6cbf"))}},data:function(){return{exportKey:f["a"],windowWidth:window.innerWidth,symbol:"$",indexMetaData:{summary:{currency:{symbol:""},total_credit:"0.00",avg_credit_per_day:"0.00",total_debit:"0.00",avg_debit_per_day:"0.00"},count:{total:0}},tableHeaders:[{text:this.$t("components.paymentManagement.table.columns.invoiceID"),width:"10%",sort:"id"},{text:this.$t("components.paymentManagement.table.columns.payerName"),width:"14%",sort:"user"},{text:this.$t("components.paymentManagement.table.columns.transactionTime"),width:"15%",sort:"date"},{text:this.$t("components.paymentManagement.table.columns.paymentMethod"),width:"15%",sort:"payment"},{text:this.$t("components.paymentManagement.table.columns.paymentRef"),width:"10%",sort:null},{text:this.$t("components.paymentManagement.table.columns.paymentFor"),width:"17%",sort:"payment_for"},{text:this.$t("components.paymentManagement.table.columns.amount"),width:"7%",sort:"amount"},{text:this.$t("components.paymentManagement.table.columns.refund"),width:"7%",sort:"amount"},{text:this.$t("components.paymentManagement.table.columns.invoice"),width:"5%",sort:null},{text:this.$t("components.paymentManagement.table.columns.actions"),width:"8%",sort:null}],resTableHeaders:[{text:"",width:"10%",sort:null},{text:this.$t("components.paymentManagement.table.columns.invoiceID"),width:"25%",sort:"id"},{text:this.$t("components.paymentManagement.table.columns.paymentMethod"),width:"35%",sort:"payment"},{text:this.$t("components.paymentManagement.table.columns.amount"),width:"30%",sort:"amount"}],opened:[],filterOptions:[],paymentMethod:""}},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.symbol=(null===(n=t.$org)||void 0===n||null===(a=n.default_currency)||void 0===a?void 0:a.symbol)||"$",e.next=3,t.generateFilterOptions();case 3:return e.next=5,t.$http.get(u["c"].dropdown.paymentGateways()).then((function(t){return t.data.data})).catch((function(t){return console.log("paymentGatewayErr",t)}));case 5:s=e.sent,r=s.find((function(t){return t.id===JSON.parse(localStorage.getItem("organization")).default_payment_gateway_config.payment_gateway})),t.paymentMethod=r.name;case 8:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;this.$nextTick((function(){window.addEventListener("resize",t.onResize)}))},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},computed:{getTableHeaders:function(){return this.windowWidth<=930?this.resTableHeaders:this.tableHeaders},getTableMode:function(){return this.windowWidth<=930?"responsive":"full"},getCurrencyAttributes:function(){return Object(l["f"])({root:"",def:{amount:"amount",currencyName:"currency.name",currencySymbol:"currency.symbol"},actual:{amount:"amount",currencyName:"currency.name",currencySymbol:"currency.symbol"}})},getFilteredItems:function(){if(this.filterItems.length){if(this.filterItems.length===this.filterOptions.length){var t=this.filterItems;return t.push({}),t}return this.filterItems}return this.filterOptions}},methods:{onApplyFilterDateRange:l["g"],getRefundTooltip:d["a"],getFormattedDateTime:c["c"],truncate:m["a"],convertSecondsToMinutesAndSeconds:c["a"],onResize:function(){this.windowWidth=window.innerWidth},copyTextToClipboard:function(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-99999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$notify({group:"generic",type:"success",title:"Payment Reference link Copied",text:"The Payment Reference link has been copied to your clipboard"},2e3)},toggle:function(t){var e=this.opened.indexOf(t);e>-1?this.opened.splice(e,1):this.opened.push(t)},onFilter:function(t,e){this.$store.commit("fsTable/addQsa",{id:t,payload:e})},onFilterClear:function(t){this.$store.commit("fsTable/clearQsa",{id:t})},popup:function(t){i["a"].$emit(o["a"].events.viewingData,t),this.$modal.show(o["a"].events.viewingData)},printAmount:function(t,e){var n="Card"===t?"text-oGreen":"";return'<span class="'.concat(n,'">').concat(this.symbol," ").concat(e?parseFloat(e).toFixed(2):"0.00","</span>")},generateFilterOptions:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[{key:"payment_type",type:"checkbox",input:[{text:"Card Topup",value:"Topup"},{text:"Agent Topup",value:"Agent Topup"},{text:"Signup Bonus",value:"Initial Balance"},{text:"Referral Bonus by Invitee",value:"Invitee Invitation Amount"},{text:"Referral Bonus by Inviter",value:"Inviter Invitation Amount"},{text:"Balance Transfer by Admin",value:"Rider Balance Adjust"},{text:"Charged for Pass Subscription",value:"Charged for Pass Subscription"},{text:"Pass Subscription using eWallet",value:"Pass Subscription using eWallet"}],title:"Payment Type"},{key:"refund_status",type:"checkbox",input:[{text:"Refunded",value:"refunded"}],title:"Refund Status"}],!t.$acl.canView("fleets")){e.next=9;break}return a=[],e.next=5,t.$http.get("/dashboard/fleets/").then((function(t){var e=t.data;e.data.length&&e.data.forEach((function(t){a.push({text:t.name,value:t.id})}))}));case 5:n.unshift({key:"fleet",type:"checkbox",input:a,title:"Fleet"}),t.filterOptions=n,e.next=10;break;case 9:t.filterOptions=n;case 10:case"end":return e.stop()}}),e)})))()},getPaymentCardIconClass:function(t){var e,n=(null===t||void 0===t||null===(e=t.brand)||void 0===e?void 0:e.toLowerCase())||"",a="fab ";switch(null===n||void 0===n?void 0:n.toLowerCase()){case"visa":a+="fa-cc-visa";break;case"mastercard":a+="fa-cc-mastercard";break;case"americanexpress":a+="fa-cc-amex";break;case"discover":a+="fa-cc-discover";break;case"jcb":a+="fa-cc-jcb";break;case"dinersclub":a+="fa-cc-diners-club";break;default:a="fas fa-wallet";break}return a},getPaymentForText:function(t){if(t.isArray)return t;var e=[{text:"Card Topup",value:"Topup"},{text:"Agent Topup",value:"Agent Topup"},{text:"Signup Bonus",value:"Initial Balance"},{text:"Referral Bonus by Invitee",value:"Invitee Invitation Amount"},{text:"Referral Bonus by Inviter",value:"Inviter Invitation Amount"},{text:"Balance Transfer by Admin",value:"Rider Balance Adjust"}],n=e.filter((function(e){return e.value===t}));return n.length>0?n[0].text:t},showRefundPopup:function(t){this.$acl.canNotUpdate("transaction")?this.$notify(this.$acl.notAbleToToast({action:"update",permission:"transaction"})):!t.is_refunded&&t.is_source_refundable&&(i["a"].$emit(o["a"].events.refundPopup,t),this.$modal.show(o["a"].events.refundPopup))},onRefunded:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("fsTable/fetchData");case 2:t.$notify({group:"generic",type:"success",title:"Refunded",text:"Successfully refunded to the rider."},3e3);case 3:case"end":return e.stop()}}),e)})))()}}},b=y,g=(n("6093"),n("2877")),h=Object(g["a"])(b,a,s,!1,null,"109a221a",null);e["a"]=h.exports},cef9:function(t,e,n){"use strict";n("870d")}}]);
//# sourceMappingURL=payment-index.37e3ecdd.js.map