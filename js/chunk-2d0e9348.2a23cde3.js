(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e9348"],{"8d17":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("t-modal",{ref:"popup",attrs:{name:e.mid,variant:"confirmation",hideCloseButton:!0,disableBodyScroll:!0}},[a("section",{staticClass:"px-4 pt-4 text-2xl font-extrabold text-center"},[e._v(" "+e._s(e.$t("components.tripManagement.details.modals.policyPenalty.headline"))+" ")]),a("div",{staticClass:"px-5 pt-5"},[a("ValidationObserver",{ref:"observer",scopedSlots:e._u([{key:"default",fn:function(t){var n=t.handleSubmit;return[a("form",{staticClass:"reason-form",attrs:{enctype:"multipart/form-data"},on:{submit:function(t){t.preventDefault(),n(e.handleTrigger())}}},[a("AppInput",{attrs:{rules:"required",type:"richselect",name:e.$t("components.tripManagement.details.modals.policyPenalty.penaltyReason.title"),label:e.$t("components.tripManagement.details.modals.policyPenalty.penaltyReason.title"),"value-attribute":"id","text-attribute":"title",placeholder:e.$t("components.tripManagement.details.modals.policyPenalty.penaltyReason.selectReason"),options:e.penaltyReasons,"hide-search-box":""},model:{value:e.models.reasonId,callback:function(t){e.$set(e.models,"reasonId",t)},expression:"models.reasonId"}}),a("div",{staticClass:"flex justify-items-start items-center mb-4"},[a("label",{staticClass:"font-bold mr-4"},[e._v(e._s(e.$t("components.tripManagement.details.modals.policyPenalty.triggerType.title")))]),a("label",{staticClass:"cursor-pointer mr-4 flex items-center"},[a("TRadioUnwrapped",{attrs:{value:"automatic",name:"penalty_type"},model:{value:e.models.penalty_type,callback:function(t){e.$set(e.models,"penalty_type",t)},expression:"models.penalty_type"}}),a("span",{staticClass:"ml-3 font-medium text-14px text-oDark"},[e._v(" "+e._s(e.$t("components.tripManagement.details.modals.policyPenalty.triggerType.automatic"))+" ")])],1),a("label",{staticClass:"cursor-pointer flex items-center"},[a("TRadioUnwrapped",{attrs:{value:"custom",name:"penalty_type"},model:{value:e.models.penalty_type,callback:function(t){e.$set(e.models,"penalty_type",t)},expression:"models.penalty_type"}}),a("span",{staticClass:"ml-3 font-medium text-14px text-oDark"},[e._v(" "+e._s(e.$t("components.tripManagement.details.modals.policyPenalty.triggerType.custom"))+" ")])],1)]),a("AppInput",{attrs:{rules:"required",type:"number",step:"0.01",name:e.$t("components.tripManagement.details.modals.policyPenalty.penaltyAmount.title"),label:e.$t("components.tripManagement.details.modals.policyPenalty.penaltyAmount.title"),placeholder:"automatic"===e.models.penalty_type?e.$t("components.tripManagement.details.modals.policyPenalty.penaltyAmount.selectPenaltyReason"):e.$t("components.tripManagement.details.modals.policyPenalty.penaltyAmount.penaltyAmount"),disabled:"automatic"===e.models.penalty_type},model:{value:e.models.deduct_amount,callback:function(t){e.$set(e.models,"deduct_amount",t)},expression:"models.deduct_amount"}}),a("AppInput",{attrs:{rules:"",label:e.$t("components.tripManagement.details.modals.policyPenalty.remarks"),type:"textarea",name:e.$t("components.tripManagement.details.modals.policyPenalty.penaltyAmount.remarks")},model:{value:e.models.remarks,callback:function(t){e.$set(e.models,"remarks",t)},expression:"models.remarks"}}),a("button",{ref:"triggerSubmitButtonRef",staticClass:"hidden",attrs:{type:"submit"}},[e._v(" Save ")])],1)]}}])})],1),a("section",{staticClass:"flex items-center justify-end px-4 py-4 mt-6 space-x-5 bg-gray-50"},[a("AppButton",{class:"w-1/2",attrs:{variant:"secondary",disabled:e.isLoading},on:{click:function(t){return e.hidePolicyPenaltyModal()}}},[e._v(" "+e._s(e.$t("components.stepNavigation.cancel"))+" ")]),a("AppButton",{class:"w-1/2",attrs:{variant:"primary",disabled:e.isLoading,isLoading:e.isLoading},on:{click:function(t){return e.$refs.triggerSubmitButtonRef.click()}}},[e._v(" "+e._s(e.$t("components.stepNavigation.apply"))+" ")])],1)])],1)},l=[],o=a("1da1"),s=(a("96cf"),a("4de4"),a("d3b7"),a("47d7")),i=a("c820"),r={name:"PolicyPenaltyPopup",props:{tripId:{type:String},penaltyReasons:{type:Array,default:function(){return[]}}},data:function(){return{mid:s["a"].events.policyPenaltyPopup,isLoading:!1,models:{reasonId:null,deduct_amount:null,penalty_type:"automatic",remarks:""}}},watch:{"models.reasonId":{deep:!1,immediate:!1,handler:function(e){this.models.deduct_amount=this.penaltyReasons.filter((function(t){return t.id===e}))[0].deduct_amount}},"models.penalty_type":{deep:!1,immediate:!1,handler:function(){var e=this;this.models.deduct_amount=this.penaltyReasons.filter((function(t){return t.id===e.models.reasonId}))[0].deduct_amount}}},methods:{hidePolicyPenaltyModal:function(){this.$modal.hide(this.mid),this.models={reasonId:null,deduct_amount:null,penalty_type:"automatic",remarks:""}},handleTrigger:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,console.log("handleTrigger",e.models,e.tripId),a=i["c"].invoice.policyPenalty(e.tripId,e.models.reasonId),n=new FormData,n.append("penalty_type",e.models.penalty_type),n.append("remarks",e.models.remarks),"custom"===e.models.penalty_type&&n.append("amount",parseFloat(e.models.deduct_amount)),t.next=9,e.$http.post(a,n).then((function(t){e.$emit("penalized"),console.log("handleTrigger-s",t)})).catch((function(t){e.$notify({group:"generic",type:"error",title:"Error",text:"".concat(t.response.data.message)},5e3)})).finally((function(){e.$modal.hide(e.mid),e.isLoading=!1,e.models={reasonId:null,deduct_amount:null,penalty_type:"automatic",remarks:""}}));case 9:case"end":return t.stop()}}),t)})))()}}},p=r,d=a("2877"),m=Object(d["a"])(p,n,l,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0e9348.2a23cde3.js.map