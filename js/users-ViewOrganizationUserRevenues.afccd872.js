(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users-ViewOrganizationUserRevenues"],{56335:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RevenueIndex",{attrs:{"fst-id":e.fstId,qso:e.qso,endpoint:e.endpoint,filterItems:e.filterOptions}})},s=[],i=a("1da1"),r=(a("159b"),a("b0c0"),a("96cf"),a("a6d6")),o=a("c820"),l={name:"ViewOrganizationUserRevenues",components:{RevenueIndex:r["a"]},data:function(){return{fstId:null,qso:{append:"",prepend:""},endpoint:null,filterOptions:[]}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fstId="franchise-revenues",e.generateEndPoint(),t.next=4,e.generateFilterOptions();case 4:case"end":return t.stop()}}),t)})))()},methods:{generateEndPoint:function(){this.endpoint=o["c"].invoice.indexOfRevenue()+"franchise_user=".concat(this.$route.params.id,"&")},generateFilterOptions:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=[],n=o["c"].fleet.indexOfStaff(e.$route.params.id),t.next=4,e.$http.get(n).then((function(e){var t=e.data;t.data.length&&t.data.forEach((function(e){a.push({text:e.name,value:e.id})}))}));case 4:e.filterOptions=[{key:"fleet",type:"checkbox",input:a,title:"Fleet"},{key:"payment_source",type:"checkbox",input:[{text:"Card",value:"CARD"},{text:"Trip",value:"TRIP"},{text:"Recharge",value:"RECHARGE"},{text:"Sign Up Bonus",value:"SIGN_UP_BONUS"},{text:"Referral Bonus",value:"REFERRAL_BONUS"},{text:"Balance Adjustment",value:"BALANCE_ADJUSTMENT"}],title:"Source"},{type:"radio",key:"status",input:[{text:"Pending",value:"P"},{text:"Completed",value:"C"}],title:"Status"},{key:"dispute_refund",type:"checkbox-keyed",input:[{key:"is_disputed",text:"Disputed",checkedValue:"true",uncheckedValue:"false"},{key:"is_refunded",text:"Refunded",checkedValue:"true",uncheckedValue:"false"}],title:"Billing"},{key:"test_range",type:"range",input:{value:[0,0],unit:e.symbol,max:9999,minQs:"min_amount",maxQs:"max_amount"},title:"Amount"}];case 5:case"end":return t.stop()}}),t)})))()}}},c=l,d=a("2877"),u=Object(d["a"])(c,n,s,!1,null,null,null);t["default"]=u.exports},a6d6:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("InvoiceModal",{attrs:{trip:e.invoiceModalDetails,symbol:e.symbol}}),a("RefundModal",{attrs:{paymentSourceEnabled:""},on:{refunded:e.onRefunded}}),a("content-section",{attrs:{spacing:!1}},[a("div",{staticClass:"content-spacing"},[a("div",{staticClass:"grid grid-cols-1 mb-10 md:grid-cols-2"},[a("div",[a("title-plus",{attrs:{title:e.$t("components.revenueManagement.headline"),"hide-plus":!0}})],1),a("div",{staticClass:"flex md:justify-end"},[a("date-range-picker",{on:{"apply-date":e.onApplyFilterDateRange,"cancel-date":e.onApplyFilterDateRange}})],1)]),a("div",{staticClass:"flex flex-col gap-4 mt-4 mb-10 md:items-center md:flex-row"},[a("SummaryCard",{attrs:{title:e.$t("components.revenueManagement.summary.totalRevenue"),value:e.indexMetaData.summary.currency.symbol+" "+e.indexMetaData.summary.total_debit,variant:"gray"}}),a("SummaryCard",{attrs:{title:e.$t("components.revenueManagement.summary.netRevenue"),value:e.indexMetaData.summary.currency.symbol+" "+e.indexMetaData.summary.net_amount,variant:"gray"}}),a("SummaryCard",{attrs:{title:e.$t("components.revenueManagement.summary.avgRevenuePerDay"),value:e.indexMetaData.summary.currency.symbol+" "+e.indexMetaData.summary.avg_debit_per_day,variant:"gray"}}),a("SummaryCard",{attrs:{title:e.$t("components.revenueManagement.summary.totalRefundAmount"),value:e.indexMetaData.summary.currency.symbol+" "+(e.indexMetaData.summary.total_refunded_amount||0),variant:"gray"}}),a("SummaryCard",{attrs:{title:e.$t("components.revenueManagement.summary.totalCardAmount"),value:e.indexMetaData.summary.currency.symbol+" "+(e.indexMetaData.summary.total_card_amount||0),variant:"gray"}}),a("SummaryCard",{attrs:{title:e.$t("components.revenueManagement.summary.totalWalletAmount"),value:e.indexMetaData.summary.currency.symbol+" "+(e.indexMetaData.summary.total_wallet_amount||0),variant:"gray"}})],1)]),e.$acl.canView("transaction")?[a("FSTable",{attrs:{qso:e.qso,"fst-id":e.fstId,headers:e.getTableHeaders,exportType:e.exportKey.REVENUE,exportFromURL:!0,endpoint:e.endpoint,"currency-enabled":!0,"currency-attributes":e.getCurrencyAttributes},on:{meta:function(t){return e.indexMetaData=t}},scopedSlots:e._u([{key:"topLeft",fn:function(t){var n=t.slotWidth;return[a("keep-alive",[a("FSTableFilter",{attrs:{"fst-id":e.fstId,"slot-width":n,options:e.getFilteredItems}})],1)]}},{key:"default",fn:function(t){var n=t.data;return[e._l(n,(function(t,n){return["full"===e.getTableMode?[a("FSTableRow",{key:n,attrs:{className:{"fst-row":!0,"host-child-trip-row":t.child_invoices.length>0},"text-fallback-always":""},on:{meta:function(t){return e.indexMetaData=t}}},[e.isTripOrRentExist(t)?a("FSTableRowItem",{attrs:{"text-fallback-always":""}},[a("router-link",{class:"text-blue-600",attrs:{to:{name:t.rental?"VehicleRentalDetail":"ViewTrip",params:{id:""+(t.rental?t.rental:t.trip)}},target:"_blank"}},[e._v(" "+e._s(t.id.substr(t.id.length-5))+" ")]),t.child_invoices.length>0?a("span",{staticClass:"bg-blue-600 child-invoice-index-badge "},[e._v("E")]):e._e()],1):a("FSTableRowItem",[e._v(" "+e._s(t.id.substr(t.id.length-5))+" "),t.child_invoices.length>0?a("span",{staticClass:"bg-blue-600 child-invoice-index-badge "},[e._v("E")]):e._e()]),a("FSTableRowItem",{attrs:{text:t.tax_plan,"text-fallback":"--",truncate:-5}}),a("FSTableRowItem",[t.user?a("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:t.user.id}},target:"_blank"}},[e._v(" "+e._s(t.user.full_name)+" ")]):a("span",[e._v(" -- ")])],1),a("FSTableRowItem",[t.user?[e._v(" "+e._s(t.user.role_name)+" ")]:[e._v(" -- ")]],2),a("FSTableRowItem",{attrs:{text:t.date,date:!0}}),t.payment_method_details?e._e():a("FSTableRowItem",{attrs:{text:t.payment_method}}),t.payment_method_details?a("FSTableRowItem",[t.payment_method&&"--"!==t.payment_method?a("i",{class:e.getPaymentCardIconClass(t.payment_method_details)}):e._e(),t.payment_method&&"--"!==t.payment_method?a("span",[e._v("  ")]):e._e(),e._v(" "+e._s(t.payment_method)+" ")]):e._e(),a("FSTableRowItem",{attrs:{text:e.getPaymentForText(t.payment_for)}}),a("FSTableRowItem",{attrs:{text:t,"as-currency":""}}),a("FSTableRowItem",{attrs:{text:t.payment_reference_id,"text-fallback":"--"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.text;return[a("span","--"===n?[e._v("--")]:["Stripe"===e.paymentMethod?a("span",{staticClass:"text-blue-500"},[a("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+n}},[e._v(e._s(e.truncate(n,-5,"")))]),a("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(t){return e.copyTextToClipboard("https://dashboard.stripe.com/payments/"+n)}}},[a("i",{staticClass:"ml-2 far fa-copy"})])]):a("span",[e._v(e._s(e.truncate(n,-5,"")))])])]}}],null,!0)}),a("FSTableRowItem",[a("OtoEyeIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(a){return e.onInvoiceModalReq(t.trip,!1)}}})],1),a("FSTableRowItem",{staticClass:"flex gap-1"},[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.getRefundTooltip(t,{ignoreSource:!0}),expression:"\n                      getRefundTooltip(item, { ignoreSource: true })\n                    ",modifiers:{bottom:!0}}],staticClass:"refund-action",class:t.is_refunded?"refunded":"refund",on:{click:function(a){return e.showRefundPopup(t)}}},[e._v(" "+e._s(t.is_refunded?e.$t("components.revenueManagement.actions.refunded"):e.$t("components.revenueManagement.actions.refund"))+" ")]),a("MoreActionsDropdown",{key:"more-actions-"+n,attrs:{id:"more-actions-"+n,data:t},on:{delete:function(t){return e.$store.dispatch("fsTable/fetchData")}}})],1)],1),e._l(t.child_invoices,(function(s,i){return a("FSTableRow",{key:"child-"+n+"-"+i,attrs:{className:"fst-row child-trip-row","text-fallback-always":""}},[e.isTripOrRentExist(s)?a("FSTableRowItem",[a("router-link",{class:"text-blue-600",attrs:{to:{name:s.rental?"VehicleRentalDetail":"ViewTrip",params:{id:""+(s.rental?s.rental:s.trip)}},target:"_blank"}},[e._v(" "+e._s(s.id.substr(s.id.length-5))+" ")]),a("span",{staticClass:"bg-gray-400 child-invoice-index-badge "},[e._v(e._s(i+1)+" ")])],1):a("FSTableRowItem",[e._v(" "+e._s(s.id.substr(s.id.length-5))+" "),a("span",{staticClass:"bg-gray-400 child-invoice-index-badge "},[e._v(e._s(i+1)+" ")])]),a("FSTableRowItem",{attrs:{text:s.tax_plan,"text-fallback":"--",truncate:-5}}),a("FSTableRowItem",[s.user?a("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:s.user.id}},target:"_blank"}},[e._v(" "+e._s(s.user.full_name)+" ")]):a("span",[e._v(" -- ")])],1),a("FSTableRowItem",[s.user?[e._v(" "+e._s(s.user.role_name)+" ")]:[e._v(" -- ")]],2),a("FSTableRowItem",{attrs:{text:s.date,date:!0}}),s.payment_method_details?e._e():a("FSTableRowItem",{attrs:{text:s.payment_method}}),s.payment_method_details?a("FSTableRowItem",[s.payment_method&&"--"!==s.payment_method?a("i",{class:e.getPaymentCardIconClass(s.payment_method_details)}):e._e(),s.payment_method&&"--"!==s.payment_method?a("span",[e._v("  ")]):e._e(),e._v(" "+e._s(s.payment_method)+" ")]):e._e(),a("FSTableRowItem",{attrs:{text:e.getPaymentForText(s.payment_for)}}),a("FSTableRowItem",{attrs:{text:s,"as-currency":""}}),a("FSTableRowItem",{attrs:{text:s.payment_reference_id,"text-fallback":"--"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.text;return[a("span","--"===n?[e._v("--")]:["Stripe"===e.paymentMethod?a("span",{staticClass:"text-blue-500"},[a("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+n}},[e._v(e._s(e.truncate(n,-5,"")))]),a("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(t){return e.copyTextToClipboard("https://dashboard.stripe.com/payments/"+n)}}},[a("i",{staticClass:"ml-2 far fa-copy"})])]):a("span",[e._v(e._s(e.truncate(n,-5,"")))])])]}}],null,!0)}),a("FSTableRowItem",[a("OtoEyeIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(t){return e.onInvoiceModalReq(s.trip,!1)}}})],1),a("FSTableRowItem",{staticClass:"flex gap-1"},[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.getRefundTooltip(s,{ignoreSource:!0}),expression:"\n                      getRefundTooltip(childItem, { ignoreSource: true })\n                    ",modifiers:{bottom:!0}}],staticClass:"refund-action",class:s.is_refunded?"refunded":"refund",on:{click:function(t){return e.showRefundPopup(s)}}},[e._v(" "+e._s(s.is_refunded?"Refunded":"Refund")+" ")]),a("MoreActionsDropdown",{key:"more-actions-"+n+"-"+i,attrs:{id:"more-actions-"+n+"-"+i,data:t},on:{delete:function(t){return e.$store.dispatch("fsTable/fetchData")}}})],1)],1)}))]:e._e(),"responsive"===e.getTableMode?[a("FSTableRow",{key:"fs-table-row-"+n,attrs:{className:{"fst-row":!0,"host-child-trip-row":t.child_invoices.length>0},"text-fallback-always":""},on:{meta:function(t){return e.indexMetaData=t}}},[a("FSTableRowItem",[a("div",{staticClass:"col-span-1 focus:text-gray-400",on:{click:function(t){return e.toggle(n)}}},[e.opened.includes(n)?a("i",{staticClass:"fas fa-minus-circle",staticStyle:{color:"#d90a20"}}):a("i",{staticClass:"fas fa-plus-circle"})])]),e.isTripOrRentExist(t)?a("FSTableRowItem",{attrs:{"text-fallback-always":""}},[a("router-link",{class:"text-blue-600",attrs:{to:{name:t.rental?"VehicleRentalDetail":"ViewTrip",params:{id:""+(t.rental?t.rental:t.trip)}},target:"_blank"}},[e._v(" "+e._s(t.id.substr(t.id.length-5))+" ")]),t.child_invoices.length>0?a("span",{staticClass:"bg-blue-600 child-invoice-index-badge "},[e._v("E")]):e._e()],1):a("FSTableRowItem",[e._v(" "+e._s(t.id.substr(t.id.length-5))+" "),t.child_invoices.length>0?a("span",{staticClass:"bg-blue-600 child-invoice-index-badge "},[e._v("E")]):e._e()]),t.payment_method_details?e._e():a("FSTableRowItem",{attrs:{text:t.payment_method}}),t.payment_method_details?a("FSTableRowItem",[t.payment_method&&"--"!==t.payment_method?a("i",{class:e.getPaymentCardIconClass(t.payment_method_details)}):e._e(),t.payment_method&&"--"!==t.payment_method?a("span",[e._v("  ")]):e._e(),e._v(" "+e._s(t.payment_method)+" ")]):e._e(),a("FSTableRowItem",{attrs:{text:t,"as-currency":""}})],1),e.opened.includes(n)?a("FSTableRow",{key:n},[a("td",{attrs:{colspan:"10"}},[a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.taxID"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(e.truncate(t.tax_plan,-5,"#")||"--")+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.rider"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[t.user?a("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:t.user.id}},target:"_blank"}},[e._v(" "+e._s(t.user.full_name)+" ")]):a("span",[e._v(" -- ")])],1)]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.payerRole"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(t.user.role_name||"--")+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.transactionTime"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(e.getFormattedDateTime(t.date,"D MMM, YY hh:mm:ss a")||"--")+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.paymentFor"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(e.getPaymentForText(t.payment_for))+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.paymentRef"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[t.payment_reference_id?a("span",["Stripe"===e.paymentMethod?a("span",{staticClass:"text-blue-500"},[a("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+t.payment_reference_id}},[e._v(e._s(e.truncate(t.payment_reference_id,-5,"")))]),a("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(a){return e.copyTextToClipboard("https://dashboard.stripe.com/payments/"+t.payment_reference_id)}}},[a("i",{staticClass:"ml-2 far fa-copy"})])]):a("span",[e._v(e._s(e.truncate(t.payment_reference_id,-5,"")))])]):a("span",[e._v("--")])])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.invoice"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[a("OtoEyeIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(a){return e.onInvoiceModalReq(t.trip,!1)}}})],1)]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.actions"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[a("div",{staticClass:"flex gap-1"},[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.getRefundTooltip(t,{ignoreSource:!0}),expression:"\n                            getRefundTooltip(item, { ignoreSource: true })\n                          ",modifiers:{bottom:!0}}],staticClass:"refund-action",class:t.is_refunded?"refunded":"refund",on:{click:function(a){return e.showRefundPopup(t)}}},[e._v(" "+e._s(t.is_refunded?"Refunded":"Refund")+" ")]),a("MoreActionsDropdown",{key:"more-actions-"+n+"-"+e.childItemIndex,attrs:{id:"more-actions-"+n+"-"+e.childItemIndex,data:t},on:{delete:function(t){return e.$store.dispatch("fsTable/fetchData")}}})],1)])])])]):e._e(),e._l(t.child_invoices,(function(s,i){return[a("FSTableRow",{key:"child-"+n+"-"+i,attrs:{className:"fst-row child-trip-row","text-fallback-always":""}},[a("FSTableRowItem",[a("div",{staticClass:"col-span-1 focus:text-gray-400",on:{click:function(t){return e.toggle(""+n+i)}}},[e.opened.includes(""+n+i)?a("i",{staticClass:"fas fa-minus-circle",staticStyle:{color:"#d90a20"}}):a("i",{staticClass:"fas fa-plus-circle"})])]),e.isTripOrRentExist(s)?a("FSTableRowItem",{attrs:{"text-fallback-always":""}},[a("router-link",{class:"text-blue-600",attrs:{to:{name:s.rental?"VehicleRentalDetail":"ViewTrip",params:{id:""+(s.rental?s.rental:s.trip)}},target:"_blank"}},[e._v(" "+e._s(s.id.substr(s.id.length-5))+" ")]),a("span",{staticClass:"bg-gray-400 child-invoice-index-badge "},[e._v(e._s(i+1)+" ")])],1):a("FSTableRowItem",[e._v(" "+e._s(s.id.substr(s.id.length-5))+" "),a("span",{staticClass:"bg-gray-400 child-invoice-index-badge "},[e._v(e._s(i+1)+" ")])]),s.payment_method_details?e._e():a("FSTableRowItem",{attrs:{text:s.payment_method}}),s.payment_method_details?a("FSTableRowItem",[t.payment_method&&"--"!==t.payment_method?a("i",{class:e.getPaymentCardIconClass(s.payment_method_details)}):e._e(),s.payment_method&&"--"!==s.payment_method?a("span",[e._v("  ")]):e._e(),e._v(" "+e._s(s.payment_method)+" ")]):e._e(),a("FSTableRowItem",{attrs:{text:s,"as-currency":""}})],1),e.opened.includes(""+n+i)?a("FSTableRow",{key:i},[a("td",{attrs:{colspan:"10"}},[a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.taxID"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(e.truncate(s.tax_plan,-5,"#")||"--")+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.rider"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[s.user?a("router-link",{staticClass:"font-extrabold text-blue-600 capitalize",attrs:{to:{name:"ViewRiderUserProfile",params:{id:s.user.id}},target:"_blank"}},[e._v(" "+e._s(s.user.full_name)+" ")]):a("span",[e._v(" -- ")])],1)]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.payerRole"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(s.user.role_name||"--")+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.transactionTime"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(e.getFormattedDateTime(s.date,"D MMM, YY hh:mm:ss a")||"--")+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.paymentFor"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[e._v(" "+e._s(e.getPaymentForText(s.payment_for))+" ")])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.paymentRef"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[s.payment_reference_id?a("span",["Stripe"===e.paymentMethod?a("span",{staticClass:"text-blue-500"},[a("a",{attrs:{target:"_blank",href:"https://dashboard.stripe.com/payments/"+s.payment_reference_id}},[e._v(e._s(e.truncate(s.payment_reference_id,-5,"")))]),a("span",{staticClass:"cursor-pointer text-gray-500",on:{click:function(t){return e.copyTextToClipboard("https://dashboard.stripe.com/payments/"+s.payment_reference_id)}}},[a("i",{staticClass:"ml-2 far fa-copy"})])]):a("span",[e._v(e._s(e.truncate(s.payment_reference_id,-5,"")))])]):a("span",[e._v("--")])])]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.invoice"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[a("OtoEyeIcon",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:"View Invoice",expression:"'View Invoice'",modifiers:{bottom:!0}}],on:{click:function(t){return e.onInvoiceModalReq(s.trip,!1)}}})],1)]),a("div",{staticClass:"grid grid-cols-10 items-center w-full expand-item"},[a("div",{staticClass:"col-span-5 left-text"},[e._v(" "+e._s(e.$t("components.revenueManagement.table.columns.actions"))+" ")]),a("div",{staticClass:"col-span-5 right-text"},[a("div",{staticClass:"flex gap-1"},[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.getRefundTooltip(s,{ignoreSource:!0}),expression:"\n                              getRefundTooltip(childItem, {\n                                ignoreSource: true,\n                              })\n                            ",modifiers:{bottom:!0}}],staticClass:"refund-action",class:s.is_refunded?"refunded":"refund",on:{click:function(t){return e.showRefundPopup(s)}}},[e._v(" "+e._s(s.is_refunded?e.$t("components.revenueManagement.actions.refunded"):e.$t("components.revenueManagement.actions.refund"))+" ")]),a("MoreActionsDropdown",{key:"more-actions-"+n+"-"+i,attrs:{id:"more-actions-"+n+"-"+i,data:t},on:{delete:function(t){return e.$store.dispatch("fsTable/fetchData")}}})],1)])])])]):e._e()]}))]:e._e()]}))]}}],null,!1,3630180328)})]:a("div",{staticClass:"py-5 font-bold text-center text-gray-600"},[e._v(" "+e._s(e.$t("components.acl.doNotHavePermission"))+" ")])],2)],1)},s=[],i=a("1da1"),r=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("7db0"),a("b0c0"),a("a434"),a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("fb6a"),a("99af"),a("b680"),a("159b"),a("4de4"),a("4a9d")),o=a("47d7"),l=a("4138"),c=a("214d"),d=a("c820"),u=a("4a6d"),m=a("ed08"),p=a("6930"),f=a("ca65"),v=a("ea91"),_={name:"Transactions",props:{pageTitle:{type:String,default:"Revenues"},fstId:{type:String,default:"revenues"},endpoint:{type:String,default:d["c"].invoice.indexOfRevenue()},qso:{type:Object,default:function(){return{append:"",prepend:""}}},filterItems:{type:Array,default:function(){return[]}}},components:{ContentSection:function(){return a.e("chunk-2d22cfc9").then(a.bind(null,"f625"))},TitlePlus:function(){return a.e("chunk-4d9af094").then(a.bind(null,"bcf7"))},OtoEyeIcon:function(){return a.e("chunk-2d2105ec").then(a.bind(null,"b833"))},DateRangePicker:function(){return Promise.all([a.e("chunk-93f91af4"),a.e("chunk-86a01c7a")]).then(a.bind(null,"d519"))},SummaryCard:function(){return a.e("chunk-560dab74").then(a.bind(null,"5ce4"))},RefundModal:function(){return a.e("chunk-092d4b04").then(a.bind(null,"6cbf"))},InvoiceModal:function(){return Promise.all([a.e("chunk-976b0870"),a.e("chunk-23565cf8"),a.e("chunk-4ceea968")]).then(a.bind(null,"7b26"))},MoreActionsDropdown:c["a"],FSTable:l["a"],FSTableRow:l["d"],FSTableRowItem:l["e"],FSTableFilter:l["b"]},data:function(){return{exportKey:v["a"],windowWidth:window.innerWidth,symbol:"$",indexMetaData:{summary:{currency:{symbol:""},total_debit:"0.00",net_amount:"0.00",avg_debit_per_day:"0.00",total_refunded_amount:"0.00",total_card_amount:"0.00",total_wallet_amount:"0.00"},count:{total:0}},tableHeaders:[{text:this.$t("components.revenueManagement.table.columns.invoiceID"),width:"7%",sort:"id"},{text:this.$t("components.revenueManagement.table.columns.taxID"),width:"7%",sort:"tax"},{text:this.$t("components.revenueManagement.table.columns.rider"),width:"10%",sort:"user"},{text:this.$t("components.revenueManagement.table.columns.payerRole"),width:"9%",sort:"user"},{text:this.$t("components.revenueManagement.table.columns.transactionTime"),width:"13%",sort:"date"},{text:this.$t("components.revenueManagement.table.columns.paymentMethod"),width:"12%",sort:"payment"},{text:this.$t("components.revenueManagement.table.columns.paymentFor"),width:"8%",sort:"payment_for"},{text:this.$t("components.revenueManagement.table.columns.amount"),width:"8%",sort:"amount"},{text:this.$t("components.revenueManagement.table.columns.paymentRef"),width:"10%",sort:null},{text:this.$t("components.revenueManagement.table.columns.invoice"),width:"5%",sort:null},{text:this.$t("components.revenueManagement.table.columns.actions"),width:"10%",sort:null}],resTableHeaders:[{text:"",width:"10%",sort:null},{text:this.$t("components.revenueManagement.table.columns.invoiceID"),width:"25%",sort:"id"},{text:this.$t("components.revenueManagement.table.columns.paymentMethod"),width:"35%",sort:"payment"},{text:this.$t("components.revenueManagement.table.columns.amount"),width:"30%",sort:"amount"}],opened:[],invoiceModalState:!1,invoiceModalDetails:{},filterOptions:[],paymentMethod:""}},computed:{getTableHeaders:function(){return this.windowWidth<=930?this.resTableHeaders:this.tableHeaders},getTableMode:function(){return this.windowWidth<=930?"responsive":"full"},getEndpoint:function(){return d["c"].invoice.indexOfRevenue()},getFilteredItems:function(){if(this.filterItems.length){if(this.filterItems.length===this.filterOptions.length){var e=this.filterItems;return e.push({}),e}return this.filterItems}return this.filterOptions},getCurrencyAttributes:function(){return Object(l["f"])({root:"",def:{amount:"amount",currencyName:"currency.name",currencySymbol:"currency.symbol"},actual:{amount:"amount",currencyName:"currency.name",currencySymbol:"currency.symbol"}})}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.symbol=(null===(a=e.$org)||void 0===a||null===(n=a.default_currency)||void 0===n?void 0:n.symbol)||"$",t.next=3,e.generateFilterOptions();case 3:return t.next=5,e.$http.get(d["c"].dropdown.paymentGateways()).then((function(e){return e.data.data})).catch((function(e){return console.log("paymentGatewayErr",e)}));case 5:s=t.sent,i=s.find((function(e){return e.id===JSON.parse(localStorage.getItem("organization")).default_payment_gateway_config.payment_gateway})),e.paymentMethod=i.name;case 8:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.$nextTick((function(){window.addEventListener("resize",e.onResize)}))},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{onApplyFilterDateRange:l["g"],getDisputeStatus:m["g"],getRefundTooltip:p["a"],truncate:u["a"],getFormattedDateTime:f["c"],onResize:function(){this.windowWidth=window.innerWidth},isTripOrRentExist:function(e){return!!e.trip||!!e.rental},copyTextToClipboard:function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-99999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),this.$notify({group:"generic",type:"success",title:"Payment Reference link Copied",text:"The Payment Reference link has been copied to your clipboard"},2e3)},toggle:function(e){var t=this.opened.indexOf(e);t>-1?this.opened.splice(t,1):this.opened.push(e)},formatDisputeReason:function(e){return e?e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "):""},popup:function(e){r["a"].$emit(o["a"].events.viewingData,e),this.$modal.show(o["a"].events.viewingData)},showRefundPopup:function(e){this.$acl.canNotUpdate("transaction")?this.$notify(this.$acl.notAbleToToast({action:"update",permission:"transaction"})):e.is_refunded||(r["a"].$emit(o["a"].events.refundPopup,e),this.$modal.show(o["a"].events.refundPopup))},printAmount:function(e,t){var a="Card"===e?"text-oGreen":"";return'<span class="'.concat(a,'">').concat(this.symbol," ").concat(t?parseFloat(t).toFixed(2):"0.00","</span>")},onRefunded:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("fsTable/fetchData");case 2:e.$notify({group:"generic",type:"success",title:"Refunded",text:"Successfully refunded to the rider."},3e3);case 3:case"end":return t.stop()}}),t)})))()},onInvoiceModalReq:function(e){var t=arguments,a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s=t.length>1&&void 0!==t[1]&&t[1],a.$notify({group:"generic",type:"default",title:"Processing",text:"The action is being executed..."},600),n.next=4,a.$http.get(a.$config.trip.api.single(e),{params:{preferred_currency:Object(m["u"])("fsTable.organizationCurrency.selected",a.$store.state)}}).then((function(e){a.invoiceModalDetails=e.data,!0===s?a.$refs.invoiceModal&&a.$refs.invoiceModal.exportToPDF():a.$modal.show("invoiceModal")})).catch((function(e){a.$notify({group:"generic",type:"error",title:"Server Error [".concat(e.response.status,"]"),text:"Unable to process the request!"},5e3)}));case 4:case"end":return n.stop()}}),n)})))()},generateFilterOptions:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=[{key:"payment_type",type:"checkbox",input:[{text:"Trip",value:"Trip"},{text:"Card Trip",value:"Trip With Card"},{text:"Reservation",value:"Reservation"},{text:"Pass Trip",value:"Pass Trip"},{text:"Balance deduct by admin",value:"Rider Balance Adjust"}],title:"Payment Type"},{key:"payment_source",type:"checkbox",input:[{text:"Card",value:"Card"},{text:"eWallet",value:"eWallet"},{text:"Subscription Credit/Pass",value:"Pass"}],title:"Payment Source"},{key:"refund_status",type:"checkbox",input:[{text:"Refunded",value:"refunded"}],title:"Refund Status"},{type:"checkbox",key:"exclude",input:[{text:"Test Rider",value:"test-user"},{text:"Refunded",value:"refunded"}],title:"Exclude"}],!e.$acl.canView("fleets")){t.next=9;break}return n=[],t.next=5,e.$http.get("/dashboard/fleets/?dropdown").then((function(e){var t=e.data;t.data.length&&t.data.forEach((function(e){n.push({text:e.name,value:e.id})}))}));case 5:a.unshift({key:"fleet",type:"checkbox",input:n,title:"Fleet"}),e.filterOptions=a,t.next=10;break;case 9:e.filterOptions=a;case 10:case"end":return t.stop()}}),t)})))()},getPaymentForText:function(e){if(e.isArray)return e;var t=[{text:"Subscription Credit/Pass",value:"Pass"},{text:"Card Trip",value:"Trip With Card"},{text:"Balance deduct by admin",value:"Rider Balance Adjust"}],a=t.filter((function(t){return t.value===e}));return a.length>0?a[0].text:e},getPaymentCardIconClass:function(e){var t,a=(null===e||void 0===e||null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())||"",n="fab ";switch(null===a||void 0===a?void 0:a.toLowerCase()){case"visa":n+="fa-cc-visa";break;case"mastercard":n+="fa-cc-mastercard";break;case"americanexpress":n+="fa-cc-amex";break;case"discover":n+="fa-cc-discover";break;case"jcb":n+="fa-cc-jcb";break;case"dinersclub":n+="fa-cc-diners-club";break;default:n="fas fa-wallet";break}return n}}},h=_,b=(a("a89a"),a("2877")),y=Object(b["a"])(h,n,s,!1,null,"bbcbd6ba",null);t["a"]=y.exports},a89a:function(e,t,a){"use strict";a("ae50")},ae50:function(e,t,a){}}]);
//# sourceMappingURL=users-ViewOrganizationUserRevenues.afccd872.js.map