(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cffeb"],{"65a7":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"flex justify-between  text-oWhite rounded-md w-48 cursor-pointer",class:e.data.owner?"bg-green-500":"bg-gray-400",on:{click:function(t){return e.openModal()}}},[n("div",{staticClass:"flex justify-center items-center px-3 py-1 "},[e.data.owner?n("span",[e._v(e._s(e.data.owner.full_name)+" ")]):n("span",[e._v("Assign Buyer")])]),e._m(0)]),n("t-modal",{ref:"popup",attrs:{name:"buyer-assign-"+e.id,variant:"confirmation",hideCloseButton:!0,disableBodyScroll:!0,escToClose:!e.isLoading,clickToClose:!e.isLoading}},[n("div",{staticClass:"relative "},[n("loading",{attrs:{active:e.isBuyerListLoading,"is-full-page":!1}}),n("section",{staticClass:"px-4 text-2xl font-extrabold text-center mt-8"},[e._v(" "+e._s(e.$t("components.marketPlaceManagement.orders.details.marketplace.steps.vehicles.modal.headline"))+" ")]),n("section",{staticClass:"px-4 py-5 mb-10 "},[n("TRichSelect",{staticClass:"h-96",attrs:{options:e.buyerList,"close-on-select":!0,"value-attribute":"id","text-attribute":"name",placeholder:e.$t("components.marketPlaceManagement.orders.details.marketplace.steps.vehicles.modal.placeHolder")},model:{value:e.form.owner,callback:function(t){e.$set(e.form,"owner",t)},expression:"form.owner"}})],1),n("section",{staticClass:"flex items-center justify-end px-4 py-4 mt-6 space-x-5 bg-gray-50"},[n("AppButton",{class:"w-1/2",attrs:{variant:"secondary"},on:{click:function(t){return e.closeModal()}}},[e._v(" Cancel ")]),n("AppButton",{class:"w-1/2",attrs:{isLoading:e.isLoading},on:{click:function(t){return e.assignBuyer()}}},[e._v(" Assign ")])],1)],1)])],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex justify-center items-center border-l w-7 p-0"},[n("i",{staticClass:"fas fa-chevron-down"})])}],i=n("2909"),s=n("1da1"),o=(n("96cf"),n("a9e3"),n("d3b7"),n("99af"),n("d81d"),n("c820")),c=n("9f07"),u=n.n(c),l={name:"VehicleAssignToBuyerAction",props:{id:{type:[String,Number],required:!0},data:{type:Object,required:!0}},data:function(){return{isBuyerListLoading:!0,isLoading:!1,buyerList:[],form:{owner:""}}},computed:{marketplaceId:function(){return this.$route.params.id}},watch:{data:{immediate:!0,deep:!1,handler:function(e){this.form.owner=e.owner.id}}},methods:{openModal:function(){this.fetchBuyerList(),this.$modal.show("buyer-assign-".concat(this.id))},closeModal:function(){this.$modal.hide("buyer-assign-".concat(this.id))},fetchBuyerList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("".concat(o["c"].dropdown.buyerList(),"?order_id=").concat(e.marketplaceId)).then((function(t){e.isBuyerListLoading=!0;var n=t.data.data.map((function(e){return{id:e.id,name:"".concat(e.full_name," (").concat(e.email,")")}}));e.buyerList=[{id:"none",name:"Unassigned"}].concat(Object(i["a"])(n))})).catch((function(e){return console.log("buyerlist-err",{err:e})})).finally((function(){return e.isBuyerListLoading=!1}));case 2:case"end":return t.stop()}}),t)})))()},assignBuyer:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isLoading=!0,"none"!==e.form.owner){t.next=7;break}return n="".concat(o["c"].vehicle.buyer.assignOwner(e.data.id),"?unassigned=true"),t.next=5,e.$http.patch(n).then((function(){e.$notify({group:"generic",type:"success",title:"Successful",text:"Unassigned Successfully"},3e3),e.closeModal(),e.$emit("force-sync")})).catch((function(t){console.log("unassigned-err",{err:t}),e.$notify({group:"generic",type:"error",title:"Error occurred!",text:"Failed to unassign"},7e3)})).finally((function(){return e.isLoading=!1}));case 5:t.next=12;break;case 7:return r=o["c"].vehicle.buyer.assignOwner(e.data.id),a=(new u.a).toFormData(),a.append("owner",e.form.owner),t.next=12,e.$http.patch(r,a).then((function(){e.$notify({group:"generic",type:"success",title:"Successful",text:"Assigned Successfully"},3e3),e.closeModal(),e.$emit("force-sync")})).catch((function(t){console.log("assigned-err",{err:t}),e.$notify({group:"generic",type:"error",title:"Error occurred!",text:"Failed to assign"},7e3)})).finally((function(){return e.isLoading=!1}));case 12:case"end":return t.stop()}}),t)})))()}}},d=l,f=n("2877"),p=Object(f["a"])(d,r,a,!1,null,"bcbd298a",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d0cffeb.0333a27b.js.map