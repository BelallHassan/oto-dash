(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bd7b9"],{"2bd7":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("t-modal",{attrs:{name:"rental-cancel",variant:"confirmation",hideCloseButton:!0,disableBodyScroll:!0,escToClose:!e.isLoading,clickToClose:!e.isLoading},on:{closed:e.onClose}},[n("section",{staticClass:"px-4 pt-4 text-2xl font-extrabold text-center"},[e._v(" Cancel Rent ")]),n("div",{staticClass:"px-5 pt-5"},[n("ValidationObserver",{ref:"observer",scopedSlots:e._u([{key:"default",fn:function(t){var o=t.handleSubmit;return[n("form",{attrs:{enctype:"multipart/form-data"},on:{submit:function(t){t.preventDefault(),o(e.onConfirm())}}},[n("AppInput",{attrs:{type:"richselect",name:"reason",label:"Reason",placeholder:"Select a reason","text-attribute":"text","value-attribute":"value","hide-search-box":"","fetch-options":e.onFetchReasons},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}}),n("button",{ref:"submitButtonRef",staticClass:"hidden",attrs:{type:"submit"}},[e._v(" Confirm ")])],1)]}}])})],1),n("section",{staticClass:"flex items-center justify-end px-4 py-4 mt-6 space-x-5 bg-gray-50"},[n("AppButton",{class:"w-1/2",attrs:{disabled:e.isLoading,variant:"secondary"},on:{click:e.onClose}},[e._v(" Close ")]),n("AppButton",{class:"w-1/2",attrs:{variant:"primary",isLoading:e.isLoading,disabled:e.isLoading},on:{click:function(t){return e.$refs.submitButtonRef.click()}}},[e._v(" Confirm ")])],1)])},a=[],s=n("1da1"),r=(n("96cf"),n("d81d"),n("b0c0"),n("ed08")),i=n("c820"),c={props:{rentId:{type:String,required:!0}},components:{},mounted:function(){this.$modal.show("rental-cancel")},data:function(){return{isLoading:!1,form:{reason:null}}},methods:{onFetchReasons:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get(i["c"].vehicleRental.cancelReasons(),{params:{search:e}}).then((function(e){var n=e.data;t.reasons=null===n||void 0===n?void 0:n.map((function(e){return{text:e.name,value:e.value}}))})).catch((function(e){console.log("onFetchReasons",e,e.response)}));case 2:return n.abrupt("return",{results:t.reasons});case 3:case"end":return n.stop()}}),n)})))()},onClose:function(e){this.$emit("close",e)},onConfirm:function(){var e=this,t=this,n=this.form;this.isLoading=!0;var o={status:"CANCELLED"};n.reason&&(o.cancel_reason=n.reason);var a=new r["x"](o).toFormData();this.$http.patch(i["c"].vehicleRental.update(this.rentId),a).then((function(n){console.log(n),e.$emit("refresh"),t.$notify({group:"bottomRight",type:"success",title:"Rental Request Cancelled",text:"The rental request has been cancelled successfully"},5e3),t.$store.dispatch("fsTable/fetchData"),t.onClose(!0)})).catch((function(e){console.log("onConfirm",e,e.response),t.$notify({group:"bottomRight",type:"error",title:"Rental Request Update Error",text:"Rental request could not be cancelled"},5e3),t.isLoading=!1}))}}},l=c,u=n("2877"),d=Object(u["a"])(l,o,a,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0bd7b9.055f8f33.js.map